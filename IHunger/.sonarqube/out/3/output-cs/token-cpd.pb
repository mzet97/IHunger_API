„
XD:\TI\git\v2\IHunger_API\IHunger\3 - Service\IHunger.Service\AddressRestaurantService.cs
	namespace 	
IHunger
 
. 
Service 
{ 
public 

class $
AddressRestaurantService )
:* +%
IAddressRestaurantService, E
{		 
}

 
} —
RD:\TI\git\v2\IHunger_API\IHunger\3 - Service\IHunger.Service\AddressUserService.cs
	namespace 	
IHunger
 
. 
Service 
{ 
public 

class 
AddressUserService #
:$ %
IAddressUserService& 9
{		 
}

 
} €π
KD:\TI\git\v2\IHunger_API\IHunger\3 - Service\IHunger.Service\AuthService.cs
	namespace 	
IHunger
 
. 
Service 
{ 
public 

class 
AuthService 
: 
BaseService *
,* +
IAuthService, 8
{ 
private 
readonly 
SignInManager &
<& '
User' +
>+ ,
_signInManager- ;
;; <
private 
readonly 
UserManager $
<$ %
User% )
>) *
_userManager+ 7
;7 8
private 
readonly 
AppSettings $
_appSettings% 1
;1 2
private 
readonly "
IProfileUserRepository /"
_profileUserRepository0 F
;F G
public 
AuthService 
( 
	INotifier 
notifier 
, 
SignInManager 
< 
User 
> 
signInManager  -
,- .
UserManager 
< 
User 
> 
userManager )
,) *
IOptions 
< 
AppSettings  
>  !
appSettings" -
,- ."
IProfileUserRepository   "!
profileUserRepository  # 8
)  8 9
:  : ;
base!! 
(!! 
notifier!! 
)!! 
{"" 	
_signInManager## 
=## 
signInManager## *
;##* +
_userManager$$ 
=$$ 
userManager$$ &
;$$& '
_appSettings%% 
=%% 
appSettings%% &
.%%& '
Value%%' ,
;%%, -"
_profileUserRepository&& "
=&&# $!
profileUserRepository&&% :
;&&: ;
}'' 	
public)) 
async)) 
Task)) 
<)) "
LoginResponseViewModel)) 0
>))0 1
Register))2 :
()): ;
User)); ?
user))@ D
,))D E
string))F L
password))M U
)))U V
{** 	
if++ 
(++ 
!++ 
Validate++ 
(++ 
new++ !
ProfileUserValidation++ 3
(++3 4
)++4 5
,++5 6
user++7 ;
.++; <
ProfileUser++< G
)++G H
)++H I
return++J P
null++Q U
;++U V
if,, 
(,, 
!,, 
Validate,, 
(,, 
new,, !
AddressUserValidation,, 3
(,,3 4
),,4 5
,,,5 6
user,,7 ;
.,,; <
ProfileUser,,< G
.,,G H
AddressUser,,H S
),,S T
),,T U
return,,V \
null,,] a
;,,a b
var.. 
resultCreateUser..  
=..! "
await..# (
_userManager..) 5
...5 6
CreateAsync..6 A
(..A B
user..B F
,..F G
password..H P
)..P Q
;..Q R
if00 
(00 
resultCreateUser00  
.00  !
	Succeeded00! *
)00* +
{11 
await22 
	AddClaims22 
(22  
user22  $
)22$ %
;22% &
await33 
_signInManager33 $
.33$ %
SignInAsync33% 0
(330 1
user331 5
,335 6
false337 <
)33< =
;33= >
return44 
await44 
GetJwt44 #
(44# $
user44$ (
.44( )
Email44) .
)44. /
;44/ 0
}55 
foreach77 
(77 
var77 
error77 
in77 !
resultCreateUser77" 2
.772 3
Errors773 9
)779 :
{88 
NotifyError99 
(99 
error99 !
.99! "
Description99" -
)99- .
;99. /
}:: 
return<< 
await<< 
GetJwt<< 
(<<  
user<<  $
.<<$ %
Email<<% *
)<<* +
;<<+ ,
}== 	
public?? 
async?? 
Task?? 
<?? "
LoginResponseViewModel?? 0
>??0 1
Login??2 7
(??7 8
string??8 >
email??? D
,??D E
string??F L
password??M U
)??U V
{@@ 	
varAA 
resultAA 
=AA 
awaitAA 
_signInManagerAA -
.AA- .
PasswordSignInAsyncAA. A
(AAA B
emailAAB G
,AAG H
passwordAAI Q
,AAQ R
falseAAS X
,AAX Y
falseAAZ _
)AA_ `
;AA` a
ifCC 
(CC 
resultCC 
.CC 
	SucceededCC  
)CC  !
{DD 
returnEE 
awaitEE 
GetJwtEE #
(EE# $
emailEE$ )
)EE) *
;EE* +
}FF 
elseGG 
ifGG 
(GG 
resultGG 
.GG 
IsLockedOutGG '
)GG' (
{HH 
NotifyErrorII 
(II 
$strII 6
)II6 7
;II7 8
returnJJ 
nullJJ 
;JJ 
}KK 
NotifyErrorMM 
(MM 
$strMM 8
)MM8 9
;MM9 :
returnNN 
nullNN 
;NN 
}OO 	
privateQQ 
asyncQQ 
TaskQQ 
<QQ 
stringQQ !
>QQ! "
CreateSecurityTokenQQ# 6
(QQ6 7
stringQQ7 =
emailQQ> C
)QQC D
{RR 	
varSS 
userSS 
=SS 
awaitSS 
GetUserSS $
(SS$ %
emailSS% *
)SS* +
;SS+ ,
ifUU 
(UU 
userUU 
==UU 
nullUU 
)UU 
{VV 
NotifyErrorWW 
(WW 
$strWW <
)WW< =
;WW= >
returnXX 
nullXX 
;XX 
}YY 
var[[ 
token[[ 
=[[ 
await[[ 
_userManager[[ *
.[[* +$
CreateSecurityTokenAsync[[+ C
([[C D
user[[D H
)[[H I
;[[I J
if]] 
(]] 
token]] 
!=]] 
null]] 
)]] 
{^^ 
return__ 
token__ 
.__ 
ToString__ %
(__% &
)__& '
;__' (
}`` 
returnbb 
nullbb 
;bb 
}cc 	
privateee 
asyncee 
Taskee 
<ee 
stringee !
>ee! "(
CreateEmailConfirmationTokenee# ?
(ee? @
stringee@ F
emaileeG L
)eeL M
{ff 	
vargg 
usergg 
=gg 
awaitgg 
GetUsergg $
(gg$ %
emailgg% *
)gg* +
;gg+ ,
ifii 
(ii 
userii 
==ii 
nullii 
)ii 
{jj 
NotifyErrorkk 
(kk 
$strkk <
)kk< =
;kk= >
returnll 
nullll 
;ll 
}mm 
varoo 
tokenoo 
=oo 
awaitoo 
_userManageroo *
.oo* +/
#GenerateEmailConfirmationTokenAsyncoo+ N
(ooN O
userooO S
)ooS T
;ooT U
ifqq 
(qq 
stringqq 
.qq 
IsNullOrWhiteSpaceqq )
(qq) *
tokenqq* /
)qq/ 0
)qq0 1
{rr 
NotifyErrorss 
(ss 
$strss 2
)ss2 3
;ss3 4
returntt 
nulltt 
;tt 
}uu 
returnww 
tokenww 
;ww 
}xx 	
privatezz 
asynczz 
Taskzz 
<zz 
stringzz !
>zz! ""
CreateEmailChangeTokenzz# 9
(zz9 :
stringzz: @
emailzzA F
,zzF G
stringzzH N
newEmailzzO W
)zzW X
{{{ 	
var|| 
user|| 
=|| 
await|| 
GetUser|| $
(||$ %
email||% *
)||* +
;||+ ,
if~~ 
(~~ 
user~~ 
==~~ 
null~~ 
)~~ 
{ 
NotifyError
ÄÄ 
(
ÄÄ 
$str
ÄÄ <
)
ÄÄ< =
;
ÄÄ= >
return
ÅÅ 
null
ÅÅ 
;
ÅÅ 
}
ÇÇ 
var
ÑÑ 
token
ÑÑ 
=
ÑÑ 
await
ÑÑ 
_userManager
ÑÑ *
.
ÑÑ* ++
GenerateChangeEmailTokenAsync
ÑÑ+ H
(
ÑÑH I
user
ÑÑI M
,
ÑÑM N
newEmail
ÑÑO W
)
ÑÑW X
;
ÑÑX Y
if
ÜÜ 
(
ÜÜ 
string
ÜÜ 
.
ÜÜ  
IsNullOrWhiteSpace
ÜÜ )
(
ÜÜ) *
token
ÜÜ* /
)
ÜÜ/ 0
)
ÜÜ0 1
{
áá 
NotifyError
àà 
(
àà 
$str
àà 2
)
àà2 3
;
àà3 4
return
ââ 
null
ââ 
;
ââ 
}
ää 
return
åå 
token
åå 
;
åå 
}
çç 	
private
èè 
async
èè 
Task
èè 
<
èè 
bool
èè 
>
èè  
ConfirmEmail
èè! -
(
èè- .
string
èè. 4
email
èè5 :
,
èè: ;
string
èè< B
token
èèC H
)
èèH I
{
êê 	
var
ëë 
user
ëë 
=
ëë 
await
ëë 
GetUser
ëë $
(
ëë$ %
email
ëë% *
)
ëë* +
;
ëë+ ,
if
ìì 
(
ìì 
user
ìì 
==
ìì 
null
ìì 
)
ìì 
{
îî 
NotifyError
ïï 
(
ïï 
$str
ïï <
)
ïï< =
;
ïï= >
return
ññ 
false
ññ 
;
ññ 
}
óó 
var
ôô 
identityResp
ôô 
=
ôô 
await
ôô $
_userManager
ôô% 1
.
ôô1 2
ConfirmEmailAsync
ôô2 C
(
ôôC D
user
ôôD H
,
ôôH I
token
ôôJ O
)
ôôO P
;
ôôP Q
if
õõ 
(
õõ 
identityResp
õõ 
.
õõ 
	Succeeded
õõ &
)
õõ& '
{
úú 
return
ùù 
true
ùù 
;
ùù 
}
ûû 
return
†† 
false
†† 
;
†† 
}
°° 	
private
££ 
async
££ 
Task
££ 
<
££ 
string
££ !
>
££! "&
CreatePasswordResetToken
££# ;
(
££; <
string
££< B
email
££C H
)
££H I
{
§§ 	
var
•• 
user
•• 
=
•• 
await
•• 
GetUser
•• $
(
••$ %
email
••% *
)
••* +
;
••+ ,
if
ßß 
(
ßß 
user
ßß 
==
ßß 
null
ßß 
)
ßß 
{
®® 
NotifyError
©© 
(
©© 
$str
©© <
)
©©< =
;
©©= >
return
™™ 
null
™™ 
;
™™ 
}
´´ 
var
≠≠ 
token
≠≠ 
=
≠≠ 
await
≠≠ 
_userManager
≠≠ *
.
≠≠* +-
GeneratePasswordResetTokenAsync
≠≠+ J
(
≠≠J K
user
≠≠K O
)
≠≠O P
;
≠≠P Q
if
ØØ 
(
ØØ 
string
ØØ 
.
ØØ  
IsNullOrWhiteSpace
ØØ )
(
ØØ) *
token
ØØ* /
)
ØØ/ 0
)
ØØ0 1
{
∞∞ 
NotifyError
±± 
(
±± 
$str
±± 2
)
±±2 3
;
±±3 4
return
≤≤ 
null
≤≤ 
;
≤≤ 
}
≥≥ 
return
µµ 
token
µµ 
;
µµ 
}
∂∂ 	
private
∏∏ 
async
∏∏ 
Task
∏∏ 
<
∏∏ 
bool
∏∏ 
>
∏∏  
RecoverPassword
∏∏! 0
(
∏∏0 1
string
∏∏1 7
email
∏∏8 =
,
∏∏= >
string
∏∏? E
password
∏∏F N
,
∏∏N O
string
∏∏P V
token
∏∏W \
)
∏∏\ ]
{
ππ 	
var
∫∫ 
user
∫∫ 
=
∫∫ 
await
∫∫ 
GetUser
∫∫ $
(
∫∫$ %
email
∫∫% *
)
∫∫* +
;
∫∫+ ,
if
ºº 
(
ºº 
user
ºº 
==
ºº 
null
ºº 
)
ºº 
{
ΩΩ 
NotifyError
ææ 
(
ææ 
$str
ææ <
)
ææ< =
;
ææ= >
return
øø 
false
øø 
;
øø 
}
¿¿ 
var
¬¬ 
identityResp
¬¬ 
=
¬¬ 
await
¬¬ $
_userManager
¬¬% 1
.
¬¬1 2!
ChangePasswordAsync
¬¬2 E
(
¬¬E F
user
¬¬F J
,
¬¬J K
password
¬¬L T
,
¬¬T U
token
¬¬V [
)
¬¬[ \
;
¬¬\ ]
if
≈≈ 
(
≈≈ 
identityResp
≈≈ 
.
≈≈ 
	Succeeded
≈≈ &
)
≈≈& '
{
∆∆ 
return
«« 
true
«« 
;
«« 
}
»» 
return
   
false
   
;
   
}
ÀÀ 	
private
ÕÕ 
async
ÕÕ 
Task
ÕÕ 
<
ÕÕ 
bool
ÕÕ 
>
ÕÕ  
ChangeEmail
ÕÕ! ,
(
ÕÕ, -
string
ÕÕ- 3
oldEmail
ÕÕ4 <
,
ÕÕ< =
string
ÕÕ> D
newEmail
ÕÕE M
,
ÕÕM N
string
ÕÕO U
token
ÕÕV [
)
ÕÕ[ \
{
ŒŒ 	
var
œœ 
user
œœ 
=
œœ 
await
œœ 
GetUser
œœ $
(
œœ$ %
oldEmail
œœ% -
)
œœ- .
;
œœ. /
if
—— 
(
—— 
user
—— 
==
—— 
null
—— 
)
—— 
{
““ 
NotifyError
”” 
(
”” 
$str
”” <
)
””< =
;
””= >
return
‘‘ 
false
‘‘ 
;
‘‘ 
}
’’ 
var
◊◊ 
identityResp
◊◊ 
=
◊◊ 
await
◊◊ $
_userManager
◊◊% 1
.
◊◊1 2
ChangeEmailAsync
◊◊2 B
(
◊◊B C
user
◊◊C G
,
◊◊G H
newEmail
◊◊I Q
,
◊◊Q R
token
◊◊S X
)
◊◊X Y
;
◊◊Y Z
if
ŸŸ 
(
ŸŸ 
identityResp
ŸŸ 
.
ŸŸ 
	Succeeded
ŸŸ &
)
ŸŸ& '
{
⁄⁄ 
return
€€ 
true
€€ 
;
€€ 
}
‹‹ 
return
ﬁﬁ 
false
ﬁﬁ 
;
ﬁﬁ 
}
ﬂﬂ 	
private
·· 
async
·· 
Task
·· 
<
·· 
bool
·· 
>
··  
ChangePassword
··! /
(
··/ 0
string
··0 6
email
··7 <
,
··< =
string
··> D
password
··E M
,
··M N
string
··O U
newPassword
··V a
)
··a b
{
‚‚ 	
var
„„ 
user
„„ 
=
„„ 
await
„„ 
GetUser
„„ $
(
„„$ %
email
„„% *
)
„„* +
;
„„+ ,
if
ÂÂ 
(
ÂÂ 
user
ÂÂ 
==
ÂÂ 
null
ÂÂ 
)
ÂÂ 
{
ÊÊ 
NotifyError
ÁÁ 
(
ÁÁ 
$str
ÁÁ <
)
ÁÁ< =
;
ÁÁ= >
return
ËË 
false
ËË 
;
ËË 
}
ÈÈ 
var
ÎÎ 
identityResp
ÎÎ 
=
ÎÎ 
await
ÎÎ $
_userManager
ÎÎ% 1
.
ÎÎ1 2!
ChangePasswordAsync
ÎÎ2 E
(
ÎÎE F
user
ÎÎF J
,
ÎÎJ K
password
ÎÎL T
,
ÎÎT U
newPassword
ÎÎV a
)
ÎÎa b
;
ÎÎb c
if
ÌÌ 
(
ÌÌ 
identityResp
ÌÌ 
.
ÌÌ 
	Succeeded
ÌÌ &
)
ÌÌ& '
{
ÓÓ 
return
ÔÔ 
true
ÔÔ 
;
ÔÔ 
}
 
return
ÚÚ 
false
ÚÚ 
;
ÚÚ 
}
ÛÛ 	
private
ıı 
async
ıı 
Task
ıı 
<
ıı 
User
ıı 
>
ıı  
GetUser
ıı! (
(
ıı( )
string
ıı) /
email
ıı0 5
)
ıı5 6
{
ˆˆ 	
return
˜˜ 
await
˜˜ 
_userManager
˜˜ %
.
˜˜% &
FindByEmailAsync
˜˜& 6
(
˜˜6 7
email
˜˜7 <
)
˜˜< =
;
˜˜= >
}
¯¯ 	
private
˙˙ 
async
˙˙ 
Task
˙˙ 
	AddClaims
˙˙ $
(
˙˙$ %
User
˙˙% )
user
˙˙* .
)
˙˙. /
{
˚˚ 	
switch
¸¸ 
(
¸¸ 
user
¸¸ 
.
¸¸ 
ProfileUser
¸¸ $
.
¸¸$ %
Type
¸¸% )
)
¸¸) *
{
˝˝ 
case
˛˛ 
(
˛˛ 
int
˛˛ 
)
˛˛ 
TypeProfile
˛˛ &
.
˛˛& '
Admin
˛˛' ,
:
˛˛, -
await
ˇˇ 
AddClaimsAdmin
ˇˇ (
(
ˇˇ( )
user
ˇˇ) -
)
ˇˇ- .
;
ˇˇ. /
break
ÄÄ 
;
ÄÄ 
case
ÅÅ 
(
ÅÅ 
int
ÅÅ 
)
ÅÅ 
TypeProfile
ÅÅ &
.
ÅÅ& '
Client
ÅÅ' -
:
ÅÅ- .
await
ÇÇ 
AddClaimsClient
ÇÇ )
(
ÇÇ) *
user
ÇÇ* .
)
ÇÇ. /
;
ÇÇ/ 0
break
ÉÉ 
;
ÉÉ 
case
ÑÑ 
(
ÑÑ 
int
ÑÑ 
)
ÑÑ 
TypeProfile
ÑÑ &
.
ÑÑ& '

Restaurant
ÑÑ' 1
:
ÑÑ1 2
await
ÖÖ !
AddClaimsRestaurant
ÖÖ -
(
ÖÖ- .
user
ÖÖ. 2
)
ÖÖ2 3
;
ÖÖ3 4
break
ÜÜ 
;
ÜÜ 
}
áá 
}
àà 	
private
ää 
async
ää 
Task
ää 
AddClaimsAdmin
ää )
(
ää) *
User
ää* .
user
ää/ 3
)
ää3 4
{
ãã 	
await
éé 
_userManager
éé 
.
éé 
AddClaimAsync
éé ,
(
éé, -
user
éé- 1
,
éé1 2
new
éé3 6
Claim
éé7 <
(
éé< =
$str
éé= C
,
ééC D
$str
ééE L
)
ééL M
)
ééM N
;
ééN O
await
êê 
_userManager
êê 
.
êê 
AddClaimAsync
êê ,
(
êê, -
user
êê- 1
,
êê1 2
new
êê3 6
Claim
êê7 <
(
êê< =
$str
êê= N
,
êêN O
$str
êêP X
)
êêX Y
)
êêY Z
;
êêZ [
await
ëë 
_userManager
ëë 
.
ëë 
AddClaimAsync
ëë ,
(
ëë, -
user
ëë- 1
,
ëë1 2
new
ëë3 6
Claim
ëë7 <
(
ëë< =
$str
ëë= N
,
ëëN O
$str
ëëP U
)
ëëU V
)
ëëV W
;
ëëW X
await
íí 
_userManager
íí 
.
íí 
AddClaimAsync
íí ,
(
íí, -
user
íí- 1
,
íí1 2
new
íí3 6
Claim
íí7 <
(
íí< =
$str
íí= N
,
ííN O
$str
ííP X
)
ííX Y
)
ííY Z
;
ííZ [
await
ìì 
_userManager
ìì 
.
ìì 
AddClaimAsync
ìì ,
(
ìì, -
user
ìì- 1
,
ìì1 2
new
ìì3 6
Claim
ìì7 <
(
ìì< =
$str
ìì= N
,
ììN O
$str
ììP X
)
ììX Y
)
ììY Z
;
ììZ [
await
ïï 
_userManager
ïï 
.
ïï 
AddClaimAsync
ïï ,
(
ïï, -
user
ïï- 1
,
ïï1 2
new
ïï3 6
Claim
ïï7 <
(
ïï< =
$str
ïï= Q
,
ïïQ R
$str
ïïS [
)
ïï[ \
)
ïï\ ]
;
ïï] ^
await
ññ 
_userManager
ññ 
.
ññ 
AddClaimAsync
ññ ,
(
ññ, -
user
ññ- 1
,
ññ1 2
new
ññ3 6
Claim
ññ7 <
(
ññ< =
$str
ññ= Q
,
ññQ R
$str
ññS X
)
ññX Y
)
ññY Z
;
ññZ [
await
óó 
_userManager
óó 
.
óó 
AddClaimAsync
óó ,
(
óó, -
user
óó- 1
,
óó1 2
new
óó3 6
Claim
óó7 <
(
óó< =
$str
óó= Q
,
óóQ R
$str
óóS [
)
óó[ \
)
óó\ ]
;
óó] ^
await
òò 
_userManager
òò 
.
òò 
AddClaimAsync
òò ,
(
òò, -
user
òò- 1
,
òò1 2
new
òò3 6
Claim
òò7 <
(
òò< =
$str
òò= Q
,
òòQ R
$str
òòS [
)
òò[ \
)
òò\ ]
;
òò] ^
await
öö 
_userManager
öö 
.
öö 
AddClaimAsync
öö ,
(
öö, -
user
öö- 1
,
öö1 2
new
öö3 6
Claim
öö7 <
(
öö< =
$str
öö= E
,
ööE F
$str
ööG O
)
ööO P
)
ööP Q
;
ööQ R
await
õõ 
_userManager
õõ 
.
õõ 
AddClaimAsync
õõ ,
(
õõ, -
user
õõ- 1
,
õõ1 2
new
õõ3 6
Claim
õõ7 <
(
õõ< =
$str
õõ= E
,
õõE F
$str
õõG L
)
õõL M
)
õõM N
;
õõN O
await
úú 
_userManager
úú 
.
úú 
AddClaimAsync
úú ,
(
úú, -
user
úú- 1
,
úú1 2
new
úú3 6
Claim
úú7 <
(
úú< =
$str
úú= E
,
úúE F
$str
úúG O
)
úúO P
)
úúP Q
;
úúQ R
await
ùù 
_userManager
ùù 
.
ùù 
AddClaimAsync
ùù ,
(
ùù, -
user
ùù- 1
,
ùù1 2
new
ùù3 6
Claim
ùù7 <
(
ùù< =
$str
ùù= E
,
ùùE F
$str
ùùG O
)
ùùO P
)
ùùP Q
;
ùùQ R
await
üü 
_userManager
üü 
.
üü 
AddClaimAsync
üü ,
(
üü, -
user
üü- 1
,
üü1 2
new
üü3 6
Claim
üü7 <
(
üü< =
$str
üü= C
,
üüC D
$str
üüE M
)
üüM N
)
üüN O
;
üüO P
await
†† 
_userManager
†† 
.
†† 
AddClaimAsync
†† ,
(
††, -
user
††- 1
,
††1 2
new
††3 6
Claim
††7 <
(
††< =
$str
††= C
,
††C D
$str
††E J
)
††J K
)
††K L
;
††L M
await
°° 
_userManager
°° 
.
°° 
AddClaimAsync
°° ,
(
°°, -
user
°°- 1
,
°°1 2
new
°°3 6
Claim
°°7 <
(
°°< =
$str
°°= C
,
°°C D
$str
°°E M
)
°°M N
)
°°N O
;
°°O P
await
¢¢ 
_userManager
¢¢ 
.
¢¢ 
AddClaimAsync
¢¢ ,
(
¢¢, -
user
¢¢- 1
,
¢¢1 2
new
¢¢3 6
Claim
¢¢7 <
(
¢¢< =
$str
¢¢= C
,
¢¢C D
$str
¢¢E M
)
¢¢M N
)
¢¢N O
;
¢¢O P
await
§§ 
_userManager
§§ 
.
§§ 
AddClaimAsync
§§ ,
(
§§, -
user
§§- 1
,
§§1 2
new
§§3 6
Claim
§§7 <
(
§§< =
$str
§§= D
,
§§D E
$str
§§F N
)
§§N O
)
§§O P
;
§§P Q
await
•• 
_userManager
•• 
.
•• 
AddClaimAsync
•• ,
(
••, -
user
••- 1
,
••1 2
new
••3 6
Claim
••7 <
(
••< =
$str
••= D
,
••D E
$str
••F K
)
••K L
)
••L M
;
••M N
await
¶¶ 
_userManager
¶¶ 
.
¶¶ 
AddClaimAsync
¶¶ ,
(
¶¶, -
user
¶¶- 1
,
¶¶1 2
new
¶¶3 6
Claim
¶¶7 <
(
¶¶< =
$str
¶¶= D
,
¶¶D E
$str
¶¶F N
)
¶¶N O
)
¶¶O P
;
¶¶P Q
await
ßß 
_userManager
ßß 
.
ßß 
AddClaimAsync
ßß ,
(
ßß, -
user
ßß- 1
,
ßß1 2
new
ßß3 6
Claim
ßß7 <
(
ßß< =
$str
ßß= D
,
ßßD E
$str
ßßF N
)
ßßN O
)
ßßO P
;
ßßP Q
await
©© 
_userManager
©© 
.
©© 
AddClaimAsync
©© ,
(
©©, -
user
©©- 1
,
©©1 2
new
©©3 6
Claim
©©7 <
(
©©< =
$str
©©= J
,
©©J K
$str
©©L T
)
©©T U
)
©©U V
;
©©V W
await
™™ 
_userManager
™™ 
.
™™ 
AddClaimAsync
™™ ,
(
™™, -
user
™™- 1
,
™™1 2
new
™™3 6
Claim
™™7 <
(
™™< =
$str
™™= J
,
™™J K
$str
™™L Q
)
™™Q R
)
™™R S
;
™™S T
await
´´ 
_userManager
´´ 
.
´´ 
AddClaimAsync
´´ ,
(
´´, -
user
´´- 1
,
´´1 2
new
´´3 6
Claim
´´7 <
(
´´< =
$str
´´= J
,
´´J K
$str
´´L T
)
´´T U
)
´´U V
;
´´V W
await
¨¨ 
_userManager
¨¨ 
.
¨¨ 
AddClaimAsync
¨¨ ,
(
¨¨, -
user
¨¨- 1
,
¨¨1 2
new
¨¨3 6
Claim
¨¨7 <
(
¨¨< =
$str
¨¨= J
,
¨¨J K
$str
¨¨L T
)
¨¨T U
)
¨¨U V
;
¨¨V W
await
ÆÆ 
_userManager
ÆÆ 
.
ÆÆ 
AddClaimAsync
ÆÆ ,
(
ÆÆ, -
user
ÆÆ- 1
,
ÆÆ1 2
new
ÆÆ3 6
Claim
ÆÆ7 <
(
ÆÆ< =
$str
ÆÆ= F
,
ÆÆF G
$str
ÆÆH P
)
ÆÆP Q
)
ÆÆQ R
;
ÆÆR S
await
ØØ 
_userManager
ØØ 
.
ØØ 
AddClaimAsync
ØØ ,
(
ØØ, -
user
ØØ- 1
,
ØØ1 2
new
ØØ3 6
Claim
ØØ7 <
(
ØØ< =
$str
ØØ= F
,
ØØF G
$str
ØØH M
)
ØØM N
)
ØØN O
;
ØØO P
await
∞∞ 
_userManager
∞∞ 
.
∞∞ 
AddClaimAsync
∞∞ ,
(
∞∞, -
user
∞∞- 1
,
∞∞1 2
new
∞∞3 6
Claim
∞∞7 <
(
∞∞< =
$str
∞∞= F
,
∞∞F G
$str
∞∞H P
)
∞∞P Q
)
∞∞Q R
;
∞∞R S
await
±± 
_userManager
±± 
.
±± 
AddClaimAsync
±± ,
(
±±, -
user
±±- 1
,
±±1 2
new
±±3 6
Claim
±±7 <
(
±±< =
$str
±±= F
,
±±F G
$str
±±H P
)
±±P Q
)
±±Q R
;
±±R S
await
≥≥ 
_userManager
≥≥ 
.
≥≥ 
AddClaimAsync
≥≥ ,
(
≥≥, -
user
≥≥- 1
,
≥≥1 2
new
≥≥3 6
Claim
≥≥7 <
(
≥≥< =
$str
≥≥= F
,
≥≥F G
$str
≥≥H P
)
≥≥P Q
)
≥≥Q R
;
≥≥R S
await
¥¥ 
_userManager
¥¥ 
.
¥¥ 
AddClaimAsync
¥¥ ,
(
¥¥, -
user
¥¥- 1
,
¥¥1 2
new
¥¥3 6
Claim
¥¥7 <
(
¥¥< =
$str
¥¥= F
,
¥¥F G
$str
¥¥H M
)
¥¥M N
)
¥¥N O
;
¥¥O P
await
µµ 
_userManager
µµ 
.
µµ 
AddClaimAsync
µµ ,
(
µµ, -
user
µµ- 1
,
µµ1 2
new
µµ3 6
Claim
µµ7 <
(
µµ< =
$str
µµ= F
,
µµF G
$str
µµH P
)
µµP Q
)
µµQ R
;
µµR S
await
∂∂ 
_userManager
∂∂ 
.
∂∂ 
AddClaimAsync
∂∂ ,
(
∂∂, -
user
∂∂- 1
,
∂∂1 2
new
∂∂3 6
Claim
∂∂7 <
(
∂∂< =
$str
∂∂= F
,
∂∂F G
$str
∂∂H P
)
∂∂P Q
)
∂∂Q R
;
∂∂R S
await
∏∏ 
_userManager
∏∏ 
.
∏∏ 
AddClaimAsync
∏∏ ,
(
∏∏, -
user
∏∏- 1
,
∏∏1 2
new
∏∏3 6
Claim
∏∏7 <
(
∏∏< =
$str
∏∏= I
,
∏∏I J
$str
∏∏K S
)
∏∏S T
)
∏∏T U
;
∏∏U V
await
ππ 
_userManager
ππ 
.
ππ 
AddClaimAsync
ππ ,
(
ππ, -
user
ππ- 1
,
ππ1 2
new
ππ3 6
Claim
ππ7 <
(
ππ< =
$str
ππ= I
,
ππI J
$str
ππK P
)
ππP Q
)
ππQ R
;
ππR S
await
∫∫ 
_userManager
∫∫ 
.
∫∫ 
AddClaimAsync
∫∫ ,
(
∫∫, -
user
∫∫- 1
,
∫∫1 2
new
∫∫3 6
Claim
∫∫7 <
(
∫∫< =
$str
∫∫= I
,
∫∫I J
$str
∫∫K S
)
∫∫S T
)
∫∫T U
;
∫∫U V
await
ªª 
_userManager
ªª 
.
ªª 
AddClaimAsync
ªª ,
(
ªª, -
user
ªª- 1
,
ªª1 2
new
ªª3 6
Claim
ªª7 <
(
ªª< =
$str
ªª= I
,
ªªI J
$str
ªªK S
)
ªªS T
)
ªªT U
;
ªªU V
}
ºº 	
private
ææ 
async
ææ 
Task
ææ 
AddClaimsClient
ææ *
(
ææ* +
User
ææ+ /
user
ææ0 4
)
ææ4 5
{
øø 	
await
¬¬ 
_userManager
¬¬ 
.
¬¬ 
AddClaimAsync
¬¬ ,
(
¬¬, -
user
¬¬- 1
,
¬¬1 2
new
¬¬3 6
Claim
¬¬7 <
(
¬¬< =
$str
¬¬= C
,
¬¬C D
$str
¬¬E M
)
¬¬M N
)
¬¬N O
;
¬¬O P
await
ƒƒ 
_userManager
ƒƒ 
.
ƒƒ 
AddClaimAsync
ƒƒ ,
(
ƒƒ, -
user
ƒƒ- 1
,
ƒƒ1 2
new
ƒƒ3 6
Claim
ƒƒ7 <
(
ƒƒ< =
$str
ƒƒ= N
,
ƒƒN O
$str
ƒƒP U
)
ƒƒU V
)
ƒƒV W
;
ƒƒW X
await
≈≈ 
_userManager
≈≈ 
.
≈≈ 
AddClaimAsync
≈≈ ,
(
≈≈, -
user
≈≈- 1
,
≈≈1 2
new
≈≈3 6
Claim
≈≈7 <
(
≈≈< =
$str
≈≈= Q
,
≈≈Q R
$str
≈≈S X
)
≈≈X Y
)
≈≈Y Z
;
≈≈Z [
await
∆∆ 
_userManager
∆∆ 
.
∆∆ 
AddClaimAsync
∆∆ ,
(
∆∆, -
user
∆∆- 1
,
∆∆1 2
new
∆∆3 6
Claim
∆∆7 <
(
∆∆< =
$str
∆∆= E
,
∆∆E F
$str
∆∆G L
)
∆∆L M
)
∆∆M N
;
∆∆N O
await
«« 
_userManager
«« 
.
«« 
AddClaimAsync
«« ,
(
««, -
user
««- 1
,
««1 2
new
««3 6
Claim
««7 <
(
««< =
$str
««= F
,
««F G
$str
««H M
)
««M N
)
««N O
;
««O P
await
»» 
_userManager
»» 
.
»» 
AddClaimAsync
»» ,
(
»», -
user
»»- 1
,
»»1 2
new
»»3 6
Claim
»»7 <
(
»»< =
$str
»»= J
,
»»J K
$str
»»L Q
)
»»Q R
)
»»R S
;
»»S T
await
…… 
_userManager
…… 
.
…… 
AddClaimAsync
…… ,
(
……, -
user
……- 1
,
……1 2
new
……3 6
Claim
……7 <
(
……< =
$str
……= I
,
……I J
$str
……K P
)
……P Q
)
……Q R
;
……R S
await
ÀÀ 
_userManager
ÀÀ 
.
ÀÀ 
AddClaimAsync
ÀÀ ,
(
ÀÀ, -
user
ÀÀ- 1
,
ÀÀ1 2
new
ÀÀ3 6
Claim
ÀÀ7 <
(
ÀÀ< =
$str
ÀÀ= C
,
ÀÀC D
$str
ÀÀE M
)
ÀÀM N
)
ÀÀN O
;
ÀÀO P
await
ÃÃ 
_userManager
ÃÃ 
.
ÃÃ 
AddClaimAsync
ÃÃ ,
(
ÃÃ, -
user
ÃÃ- 1
,
ÃÃ1 2
new
ÃÃ3 6
Claim
ÃÃ7 <
(
ÃÃ< =
$str
ÃÃ= C
,
ÃÃC D
$str
ÃÃE J
)
ÃÃJ K
)
ÃÃK L
;
ÃÃL M
await
ÕÕ 
_userManager
ÕÕ 
.
ÕÕ 
AddClaimAsync
ÕÕ ,
(
ÕÕ, -
user
ÕÕ- 1
,
ÕÕ1 2
new
ÕÕ3 6
Claim
ÕÕ7 <
(
ÕÕ< =
$str
ÕÕ= C
,
ÕÕC D
$str
ÕÕE M
)
ÕÕM N
)
ÕÕN O
;
ÕÕO P
await
ŒŒ 
_userManager
ŒŒ 
.
ŒŒ 
AddClaimAsync
ŒŒ ,
(
ŒŒ, -
user
ŒŒ- 1
,
ŒŒ1 2
new
ŒŒ3 6
Claim
ŒŒ7 <
(
ŒŒ< =
$str
ŒŒ= C
,
ŒŒC D
$str
ŒŒE M
)
ŒŒM N
)
ŒŒN O
;
ŒŒO P
await
–– 
_userManager
–– 
.
–– 
AddClaimAsync
–– ,
(
––, -
user
––- 1
,
––1 2
new
––3 6
Claim
––7 <
(
––< =
$str
––= D
,
––D E
$str
––F N
)
––N O
)
––O P
;
––P Q
await
—— 
_userManager
—— 
.
—— 
AddClaimAsync
—— ,
(
——, -
user
——- 1
,
——1 2
new
——3 6
Claim
——7 <
(
——< =
$str
——= D
,
——D E
$str
——F K
)
——K L
)
——L M
;
——M N
await
““ 
_userManager
““ 
.
““ 
AddClaimAsync
““ ,
(
““, -
user
““- 1
,
““1 2
new
““3 6
Claim
““7 <
(
““< =
$str
““= D
,
““D E
$str
““F N
)
““N O
)
““O P
;
““P Q
await
”” 
_userManager
”” 
.
”” 
AddClaimAsync
”” ,
(
””, -
user
””- 1
,
””1 2
new
””3 6
Claim
””7 <
(
””< =
$str
””= D
,
””D E
$str
””F N
)
””N O
)
””O P
;
””P Q
await
’’ 
_userManager
’’ 
.
’’ 
AddClaimAsync
’’ ,
(
’’, -
user
’’- 1
,
’’1 2
new
’’3 6
Claim
’’7 <
(
’’< =
$str
’’= F
,
’’F G
$str
’’H M
)
’’M N
)
’’N O
;
’’O P
await
÷÷ 
_userManager
÷÷ 
.
÷÷ 
AddClaimAsync
÷÷ ,
(
÷÷, -
user
÷÷- 1
,
÷÷1 2
new
÷÷3 6
Claim
÷÷7 <
(
÷÷< =
$str
÷÷= F
,
÷÷F G
$str
÷÷H P
)
÷÷P Q
)
÷÷Q R
;
÷÷R S
}
◊◊ 	
private
ŸŸ 
async
ŸŸ 
Task
ŸŸ !
AddClaimsRestaurant
ŸŸ .
(
ŸŸ. /
User
ŸŸ/ 3
user
ŸŸ4 8
)
ŸŸ8 9
{
⁄⁄ 	
await
›› 
_userManager
›› 
.
›› 
AddClaimAsync
›› ,
(
››, -
user
››- 1
,
››1 2
new
››3 6
Claim
››7 <
(
››< =
$str
››= C
,
››C D
$str
››E Q
)
››Q R
)
››R S
;
››S T
await
ﬂﬂ 
_userManager
ﬂﬂ 
.
ﬂﬂ 
AddClaimAsync
ﬂﬂ ,
(
ﬂﬂ, -
user
ﬂﬂ- 1
,
ﬂﬂ1 2
new
ﬂﬂ3 6
Claim
ﬂﬂ7 <
(
ﬂﬂ< =
$str
ﬂﬂ= F
,
ﬂﬂF G
$str
ﬂﬂH P
)
ﬂﬂP Q
)
ﬂﬂQ R
;
ﬂﬂR S
await
‡‡ 
_userManager
‡‡ 
.
‡‡ 
AddClaimAsync
‡‡ ,
(
‡‡, -
user
‡‡- 1
,
‡‡1 2
new
‡‡3 6
Claim
‡‡7 <
(
‡‡< =
$str
‡‡= F
,
‡‡F G
$str
‡‡H M
)
‡‡M N
)
‡‡N O
;
‡‡O P
await
·· 
_userManager
·· 
.
·· 
AddClaimAsync
·· ,
(
··, -
user
··- 1
,
··1 2
new
··3 6
Claim
··7 <
(
··< =
$str
··= F
,
··F G
$str
··H P
)
··P Q
)
··Q R
;
··R S
await
‚‚ 
_userManager
‚‚ 
.
‚‚ 
AddClaimAsync
‚‚ ,
(
‚‚, -
user
‚‚- 1
,
‚‚1 2
new
‚‚3 6
Claim
‚‚7 <
(
‚‚< =
$str
‚‚= F
,
‚‚F G
$str
‚‚H P
)
‚‚P Q
)
‚‚Q R
;
‚‚R S
await
‰‰ 
_userManager
‰‰ 
.
‰‰ 
AddClaimAsync
‰‰ ,
(
‰‰, -
user
‰‰- 1
,
‰‰1 2
new
‰‰3 6
Claim
‰‰7 <
(
‰‰< =
$str
‰‰= E
,
‰‰E F
$str
‰‰G O
)
‰‰O P
)
‰‰P Q
;
‰‰Q R
await
ÂÂ 
_userManager
ÂÂ 
.
ÂÂ 
AddClaimAsync
ÂÂ ,
(
ÂÂ, -
user
ÂÂ- 1
,
ÂÂ1 2
new
ÂÂ3 6
Claim
ÂÂ7 <
(
ÂÂ< =
$str
ÂÂ= E
,
ÂÂE F
$str
ÂÂG L
)
ÂÂL M
)
ÂÂM N
;
ÂÂN O
await
ÊÊ 
_userManager
ÊÊ 
.
ÊÊ 
AddClaimAsync
ÊÊ ,
(
ÊÊ, -
user
ÊÊ- 1
,
ÊÊ1 2
new
ÊÊ3 6
Claim
ÊÊ7 <
(
ÊÊ< =
$str
ÊÊ= E
,
ÊÊE F
$str
ÊÊG O
)
ÊÊO P
)
ÊÊP Q
;
ÊÊQ R
await
ËË 
_userManager
ËË 
.
ËË 
AddClaimAsync
ËË ,
(
ËË, -
user
ËË- 1
,
ËË1 2
new
ËË3 6
Claim
ËË7 <
(
ËË< =
$str
ËË= I
,
ËËI J
$str
ËËK S
)
ËËS T
)
ËËT U
;
ËËU V
await
ÈÈ 
_userManager
ÈÈ 
.
ÈÈ 
AddClaimAsync
ÈÈ ,
(
ÈÈ, -
user
ÈÈ- 1
,
ÈÈ1 2
new
ÈÈ3 6
Claim
ÈÈ7 <
(
ÈÈ< =
$str
ÈÈ= I
,
ÈÈI J
$str
ÈÈK P
)
ÈÈP Q
)
ÈÈQ R
;
ÈÈR S
await
ÍÍ 
_userManager
ÍÍ 
.
ÍÍ 
AddClaimAsync
ÍÍ ,
(
ÍÍ, -
user
ÍÍ- 1
,
ÍÍ1 2
new
ÍÍ3 6
Claim
ÍÍ7 <
(
ÍÍ< =
$str
ÍÍ= I
,
ÍÍI J
$str
ÍÍK S
)
ÍÍS T
)
ÍÍT U
;
ÍÍU V
await
ÏÏ 
_userManager
ÏÏ 
.
ÏÏ 
AddClaimAsync
ÏÏ ,
(
ÏÏ, -
user
ÏÏ- 1
,
ÏÏ1 2
new
ÏÏ3 6
Claim
ÏÏ7 <
(
ÏÏ< =
$str
ÏÏ= F
,
ÏÏF G
$str
ÏÏH M
)
ÏÏM N
)
ÏÏN O
;
ÏÏO P
await
ÌÌ 
_userManager
ÌÌ 
.
ÌÌ 
AddClaimAsync
ÌÌ ,
(
ÌÌ, -
user
ÌÌ- 1
,
ÌÌ1 2
new
ÌÌ3 6
Claim
ÌÌ7 <
(
ÌÌ< =
$str
ÌÌ= F
,
ÌÌF G
$str
ÌÌH P
)
ÌÌP Q
)
ÌÌQ R
;
ÌÌR S
await
ÔÔ 
_userManager
ÔÔ 
.
ÔÔ 
AddClaimAsync
ÔÔ ,
(
ÔÔ, -
user
ÔÔ- 1
,
ÔÔ1 2
new
ÔÔ3 6
Claim
ÔÔ7 <
(
ÔÔ< =
$str
ÔÔ= J
,
ÔÔJ K
$str
ÔÔL T
)
ÔÔT U
)
ÔÔU V
;
ÔÔV W
await
 
_userManager
 
.
 
AddClaimAsync
 ,
(
, -
user
- 1
,
1 2
new
3 6
Claim
7 <
(
< =
$str
= J
,
J K
$str
L Q
)
Q R
)
R S
;
S T
await
ÒÒ 
_userManager
ÒÒ 
.
ÒÒ 
AddClaimAsync
ÒÒ ,
(
ÒÒ, -
user
ÒÒ- 1
,
ÒÒ1 2
new
ÒÒ3 6
Claim
ÒÒ7 <
(
ÒÒ< =
$str
ÒÒ= J
,
ÒÒJ K
$str
ÒÒL T
)
ÒÒT U
)
ÒÒU V
;
ÒÒV W
await
ÚÚ 
_userManager
ÚÚ 
.
ÚÚ 
AddClaimAsync
ÚÚ ,
(
ÚÚ, -
user
ÚÚ- 1
,
ÚÚ1 2
new
ÚÚ3 6
Claim
ÚÚ7 <
(
ÚÚ< =
$str
ÚÚ= J
,
ÚÚJ K
$str
ÚÚL T
)
ÚÚT U
)
ÚÚU V
;
ÚÚV W
await
ÙÙ 
_userManager
ÙÙ 
.
ÙÙ 
AddClaimAsync
ÙÙ ,
(
ÙÙ, -
user
ÙÙ- 1
,
ÙÙ1 2
new
ÙÙ3 6
Claim
ÙÙ7 <
(
ÙÙ< =
$str
ÙÙ= D
,
ÙÙD E
$str
ÙÙF K
)
ÙÙK L
)
ÙÙL M
;
ÙÙM N
await
ıı 
_userManager
ıı 
.
ıı 
AddClaimAsync
ıı ,
(
ıı, -
user
ıı- 1
,
ıı1 2
new
ıı3 6
Claim
ıı7 <
(
ıı< =
$str
ıı= D
,
ııD E
$str
ııF N
)
ııN O
)
ııO P
;
ııP Q
await
ˆˆ 
_userManager
ˆˆ 
.
ˆˆ 
AddClaimAsync
ˆˆ ,
(
ˆˆ, -
user
ˆˆ- 1
,
ˆˆ1 2
new
ˆˆ3 6
Claim
ˆˆ7 <
(
ˆˆ< =
$str
ˆˆ= D
,
ˆˆD E
$str
ˆˆF N
)
ˆˆN O
)
ˆˆO P
;
ˆˆP Q
await
¯¯ 
_userManager
¯¯ 
.
¯¯ 
AddClaimAsync
¯¯ ,
(
¯¯, -
user
¯¯- 1
,
¯¯1 2
new
¯¯3 6
Claim
¯¯7 <
(
¯¯< =
$str
¯¯= Q
,
¯¯Q R
$str
¯¯S [
)
¯¯[ \
)
¯¯\ ]
;
¯¯] ^
await
˘˘ 
_userManager
˘˘ 
.
˘˘ 
AddClaimAsync
˘˘ ,
(
˘˘, -
user
˘˘- 1
,
˘˘1 2
new
˘˘3 6
Claim
˘˘7 <
(
˘˘< =
$str
˘˘= Q
,
˘˘Q R
$str
˘˘S X
)
˘˘X Y
)
˘˘Y Z
;
˘˘Z [
await
˙˙ 
_userManager
˙˙ 
.
˙˙ 
AddClaimAsync
˙˙ ,
(
˙˙, -
user
˙˙- 1
,
˙˙1 2
new
˙˙3 6
Claim
˙˙7 <
(
˙˙< =
$str
˙˙= Q
,
˙˙Q R
$str
˙˙S [
)
˙˙[ \
)
˙˙\ ]
;
˙˙] ^
await
¸¸ 
_userManager
¸¸ 
.
¸¸ 
AddClaimAsync
¸¸ ,
(
¸¸, -
user
¸¸- 1
,
¸¸1 2
new
¸¸3 6
Claim
¸¸7 <
(
¸¸< =
$str
¸¸= N
,
¸¸N O
$str
¸¸P X
)
¸¸X Y
)
¸¸Y Z
;
¸¸Z [
await
˝˝ 
_userManager
˝˝ 
.
˝˝ 
AddClaimAsync
˝˝ ,
(
˝˝, -
user
˝˝- 1
,
˝˝1 2
new
˝˝3 6
Claim
˝˝7 <
(
˝˝< =
$str
˝˝= N
,
˝˝N O
$str
˝˝P U
)
˝˝U V
)
˝˝V W
;
˝˝W X
await
˛˛ 
_userManager
˛˛ 
.
˛˛ 
AddClaimAsync
˛˛ ,
(
˛˛, -
user
˛˛- 1
,
˛˛1 2
new
˛˛3 6
Claim
˛˛7 <
(
˛˛< =
$str
˛˛= N
,
˛˛N O
$str
˛˛P X
)
˛˛X Y
)
˛˛Y Z
;
˛˛Z [
}
ˇˇ 	
public
ÇÇ 
async
ÇÇ 
Task
ÇÇ 
<
ÇÇ $
LoginResponseViewModel
ÇÇ 0
>
ÇÇ0 1
GetJwt
ÇÇ2 8
(
ÇÇ8 9
string
ÇÇ9 ?
email
ÇÇ@ E
)
ÇÇE F
{
ÉÉ 	
var
ÑÑ 
user
ÑÑ 
=
ÑÑ 
await
ÑÑ 
_userManager
ÑÑ )
.
ÑÑ) *
FindByEmailAsync
ÑÑ* :
(
ÑÑ: ;
email
ÑÑ; @
)
ÑÑ@ A
;
ÑÑA B
var
ÖÖ 
claims
ÖÖ 
=
ÖÖ 
await
ÖÖ 
_userManager
ÖÖ +
.
ÖÖ+ ,
GetClaimsAsync
ÖÖ, :
(
ÖÖ: ;
user
ÖÖ; ?
)
ÖÖ? @
;
ÖÖ@ A
var
ÜÜ 
	userRoles
ÜÜ 
=
ÜÜ 
await
ÜÜ !
_userManager
ÜÜ" .
.
ÜÜ. /
GetRolesAsync
ÜÜ/ <
(
ÜÜ< =
user
ÜÜ= A
)
ÜÜA B
;
ÜÜB C
claims
àà 
.
àà 
Add
àà 
(
àà 
new
àà 
Claim
àà  
(
àà  !%
JwtRegisteredClaimNames
àà! 8
.
àà8 9
Sub
àà9 <
,
àà< =
user
àà> B
.
ààB C
Id
ààC E
.
ààE F
ToString
ààF N
(
ààN O
)
ààO P
)
ààP Q
)
ààQ R
;
ààR S
claims
ââ 
.
ââ 
Add
ââ 
(
ââ 
new
ââ 
Claim
ââ  
(
ââ  !%
JwtRegisteredClaimNames
ââ! 8
.
ââ8 9
Email
ââ9 >
,
ââ> ?
user
ââ@ D
.
ââD E
Email
ââE J
)
ââJ K
)
ââK L
;
ââL M
claims
ää 
.
ää 
Add
ää 
(
ää 
new
ää 
Claim
ää  
(
ää  !%
JwtRegisteredClaimNames
ää! 8
.
ää8 9
Jti
ää9 <
,
ää< =
Guid
ää> B
.
ääB C
NewGuid
ääC J
(
ääJ K
)
ääK L
.
ääL M
ToString
ääM U
(
ääU V
)
ääV W
)
ääW X
)
ääX Y
;
ääY Z
claims
ãã 
.
ãã 
Add
ãã 
(
ãã 
new
ãã 
Claim
ãã  
(
ãã  !%
JwtRegisteredClaimNames
ãã! 8
.
ãã8 9
Nbf
ãã9 <
,
ãã< =
ToUnixEpochDate
ãã> M
(
ããM N
DateTime
ããN V
.
ããV W
UtcNow
ããW ]
)
ãã] ^
.
ãã^ _
ToString
ãã_ g
(
ããg h
)
ããh i
)
ããi j
)
ããj k
;
ããk l
claims
åå 
.
åå 
Add
åå 
(
åå 
new
åå 
Claim
åå  
(
åå  !%
JwtRegisteredClaimNames
åå! 8
.
åå8 9
Iat
åå9 <
,
åå< =
ToUnixEpochDate
åå> M
(
ååM N
DateTime
ååN V
.
ååV W
UtcNow
ååW ]
)
åå] ^
.
åå^ _
ToString
åå_ g
(
ååg h
)
ååh i
,
ååi j
ClaimValueTypes
ååk z
.
ååz {
	Integer64åå{ Ñ
)ååÑ Ö
)ååÖ Ü
;ååÜ á
foreach
éé 
(
éé 
var
éé 
userRole
éé !
in
éé" $
	userRoles
éé% .
)
éé. /
{
èè 
claims
êê 
.
êê 
Add
êê 
(
êê 
new
êê 
Claim
êê $
(
êê$ %
$str
êê% +
,
êê+ ,
userRole
êê- 5
)
êê5 6
)
êê6 7
;
êê7 8
}
ëë 
var
ìì 
identityClaims
ìì 
=
ìì  
new
ìì! $
ClaimsIdentity
ìì% 3
(
ìì3 4
claims
ìì4 :
)
ìì: ;
;
ìì; <
var
ïï 
tokenHandler
ïï 
=
ïï 
new
ïï "%
JwtSecurityTokenHandler
ïï# :
(
ïï: ;
)
ïï; <
;
ïï< =
var
ññ 
key
ññ 
=
ññ 
Encoding
ññ 
.
ññ 
ASCII
ññ $
.
ññ$ %
GetBytes
ññ% -
(
ññ- .
_appSettings
ññ. :
.
ññ: ;
Secret
ññ; A
)
ññA B
;
ññB C
var
óó 
token
óó 
=
óó 
tokenHandler
óó $
.
óó$ %
CreateToken
óó% 0
(
óó0 1
new
óó1 4%
SecurityTokenDescriptor
óó5 L
{
òò 
Issuer
ôô 
=
ôô 
_appSettings
ôô %
.
ôô% &
Issuer
ôô& ,
,
ôô, -
Audience
öö 
=
öö 
_appSettings
öö '
.
öö' (
ValidOn
öö( /
,
öö/ 0
Subject
õõ 
=
õõ 
identityClaims
õõ (
,
õõ( )
Expires
úú 
=
úú 
DateTime
úú "
.
úú" #
UtcNow
úú# )
.
úú) *
AddHours
úú* 2
(
úú2 3
_appSettings
úú3 ?
.
úú? @
ExpirationHours
úú@ O
)
úúO P
,
úúP Q 
SigningCredentials
ùù "
=
ùù# $
new
ùù% ( 
SigningCredentials
ùù) ;
(
ùù; <
new
ùù< ?"
SymmetricSecurityKey
ùù@ T
(
ùùT U
key
ùùU X
)
ùùX Y
,
ùùY Z 
SecurityAlgorithms
ùù[ m
.
ùùm n"
HmacSha256Signatureùùn Å
)ùùÅ Ç
}
ûû 
)
ûû 
;
ûû 
var
†† 
encodedToken
†† 
=
†† 
tokenHandler
†† +
.
††+ ,

WriteToken
††, 6
(
††6 7
token
††7 <
)
††< =
;
††= >
var
¢¢ 
	userToken
¢¢ 
=
¢¢ 
new
¢¢  
UserTokenViewModel
¢¢  2
(
¢¢2 3
user
¢¢3 7
.
¢¢7 8
Id
¢¢8 :
.
¢¢: ;
ToString
¢¢; C
(
¢¢C D
)
¢¢D E
,
¢¢E F
user
¢¢G K
.
¢¢K L
Email
¢¢L Q
,
¢¢Q R
claims
¢¢S Y
)
¢¢Y Z
;
¢¢Z [
var
§§ 
profile
§§ 
=
§§ 
await
§§ $
_profileUserRepository
§§  6
.
§§6 7
GetById
§§7 >
(
§§> ?
user
§§? C
.
§§C D
IdProfileUser
§§D Q
)
§§Q R
;
§§R S
if
¶¶ 
(
¶¶ 
profile
¶¶ 
!=
¶¶ 
null
¶¶ 
)
¶¶  
{
ßß 
	userToken
®® 
.
®® 
Profile
®® !
=
®®" #
new
®®$ '
ProfileViewModel
®®( 8
(
®®8 9
)
®®9 :
;
®®: ;
	userToken
©© 
.
©© 
Profile
©© !
.
©©! "
	BirthDate
©©" +
=
©©, -
profile
©©. 5
.
©©5 6
	BirthDate
©©6 ?
;
©©? @
	userToken
™™ 
.
™™ 
Profile
™™ !
.
™™! "
Name
™™" &
=
™™' (
profile
™™) 0
.
™™0 1
Name
™™1 5
;
™™5 6
	userToken
´´ 
.
´´ 
Profile
´´ !
.
´´! "
LastName
´´" *
=
´´+ ,
profile
´´- 4
.
´´4 5
LastName
´´5 =
;
´´= >
switch
≠≠ 
(
≠≠ 
profile
≠≠ 
.
≠≠  
Type
≠≠  $
)
≠≠$ %
{
ÆÆ 
case
ØØ 
$num
ØØ 
:
ØØ 
	userToken
∞∞ !
.
∞∞! "
Profile
∞∞" )
.
∞∞) *
Type
∞∞* .
=
∞∞/ 0
TypeProfile
∞∞1 <
.
∞∞< =
Admin
∞∞= B
.
∞∞B C
ToString
∞∞C K
(
∞∞K L
)
∞∞L M
;
∞∞M N
break
±± 
;
±± 
case
≤≤ 
$num
≤≤ 
:
≤≤ 
	userToken
≥≥ !
.
≥≥! "
Profile
≥≥" )
.
≥≥) *
Type
≥≥* .
=
≥≥/ 0
TypeProfile
≥≥1 <
.
≥≥< =
Client
≥≥= C
.
≥≥C D
ToString
≥≥D L
(
≥≥L M
)
≥≥M N
;
≥≥N O
break
µµ 
;
µµ 
case
∂∂ 
$num
∂∂ 
:
∂∂ 
	userToken
∑∑ !
.
∑∑! "
Profile
∑∑" )
.
∑∑) *
Type
∑∑* .
=
∑∑/ 0
TypeProfile
∑∑1 <
.
∑∑< =

Restaurant
∑∑= G
.
∑∑G H
ToString
∑∑H P
(
∑∑P Q
)
∑∑Q R
;
∑∑R S
break
∏∏ 
;
∏∏ 
default
ππ 
:
ππ 
throw
∫∫ 
new
∫∫ !
	Exception
∫∫" +
(
∫∫+ ,
$str
∫∫, ;
)
∫∫; <
;
∫∫< =
}
ªª 
if
ΩΩ 
(
ΩΩ 
profile
ΩΩ 
.
ΩΩ 
AddressUser
ΩΩ &
!=
ΩΩ' )
null
ΩΩ* .
)
ΩΩ. /
{
ææ 
	userToken
øø 
.
øø 
Address
øø %
=
øø& '
new
øø( +
AddressViewModel
øø, <
(
øø< =
)
øø= >
;
øø> ?
	userToken
¿¿ 
.
¿¿ 
Address
¿¿ %
.
¿¿% &
Street
¿¿& ,
=
¿¿- .
profile
¿¿/ 6
.
¿¿6 7
AddressUser
¿¿7 B
.
¿¿B C
Street
¿¿C I
;
¿¿I J
	userToken
¡¡ 
.
¡¡ 
Address
¡¡ %
.
¡¡% &
District
¡¡& .
=
¡¡/ 0
profile
¡¡1 8
.
¡¡8 9
AddressUser
¡¡9 D
.
¡¡D E
District
¡¡E M
;
¡¡M N
	userToken
¬¬ 
.
¬¬ 
Address
¬¬ %
.
¬¬% &
County
¬¬& ,
=
¬¬- .
profile
¬¬/ 6
.
¬¬6 7
AddressUser
¬¬7 B
.
¬¬B C
County
¬¬C I
;
¬¬I J
	userToken
√√ 
.
√√ 
Address
√√ %
.
√√% &
City
√√& *
=
√√+ ,
profile
√√- 4
.
√√4 5
AddressUser
√√5 @
.
√√@ A
City
√√A E
;
√√E F
	userToken
ƒƒ 
.
ƒƒ 
Address
ƒƒ %
.
ƒƒ% &
ZipCode
ƒƒ& -
=
ƒƒ. /
profile
ƒƒ0 7
.
ƒƒ7 8
AddressUser
ƒƒ8 C
.
ƒƒC D
ZipCode
ƒƒD K
;
ƒƒK L
	userToken
≈≈ 
.
≈≈ 
Address
≈≈ %
.
≈≈% &
Latitude
≈≈& .
=
≈≈/ 0
profile
≈≈1 8
.
≈≈8 9
AddressUser
≈≈9 D
.
≈≈D E
Latitude
≈≈E M
;
≈≈M N
	userToken
∆∆ 
.
∆∆ 
Address
∆∆ %
.
∆∆% &
	Longitude
∆∆& /
=
∆∆0 1
profile
∆∆2 9
.
∆∆9 :
AddressUser
∆∆: E
.
∆∆E F
	Longitude
∆∆F O
;
∆∆O P
}
«« 
}
»» 
var
   
response
   
=
   
new
   $
LoginResponseViewModel
   5
{
ÀÀ 
AccessToken
ÃÃ 
=
ÃÃ 
encodedToken
ÃÃ *
,
ÃÃ* +
	ExpiresIn
ÕÕ 
=
ÕÕ 
TimeSpan
ÕÕ $
.
ÕÕ$ %
	FromHours
ÕÕ% .
(
ÕÕ. /
_appSettings
ÕÕ/ ;
.
ÕÕ; <
ExpirationHours
ÕÕ< K
)
ÕÕK L
.
ÕÕL M
TotalSeconds
ÕÕM Y
,
ÕÕY Z
	UserToken
ŒŒ 
=
ŒŒ 
	userToken
ŒŒ %
}
œœ 
;
œœ 
return
—— 
response
—— 
;
—— 
}
““ 	
private
‘‘ 
static
‘‘ 
long
‘‘ 
ToUnixEpochDate
‘‘ +
(
‘‘+ ,
DateTime
‘‘, 4
date
‘‘5 9
)
‘‘9 :
=>
’’ 
(
’’ 
long
’’ 
)
’’ 
Math
’’ 
.
’’ 
Round
’’ 
(
’’ 
(
’’  
date
’’  $
.
’’$ %
ToUniversalTime
’’% 4
(
’’4 5
)
’’5 6
-
’’7 8
new
’’9 <
DateTimeOffset
’’= K
(
’’K L
$num
’’L P
,
’’P Q
$num
’’R S
,
’’S T
$num
’’U V
,
’’V W
$num
’’X Y
,
’’Y Z
$num
’’[ \
,
’’\ ]
$num
’’^ _
,
’’_ `
TimeSpan
’’a i
.
’’i j
Zero
’’j n
)
’’n o
)
’’o p
.
’’p q
TotalSeconds
’’q }
)
’’} ~
;
’’~ 
}
÷÷ 
}◊◊ ≥
KD:\TI\git\v2\IHunger_API\IHunger\3 - Service\IHunger.Service\BaseService.cs
	namespace

 	
IHunger


 
.

 
Service

 
{ 
public 

abstract 
class 
BaseService %
{ 
private 
readonly 
	INotifier "
	_notifier# ,
;, -
	protected 
BaseService 
( 
	INotifier '
notifier( 0
)0 1
{ 	
	_notifier 
= 
notifier  
;  !
} 	
	protected 
void 
NotifyError "
(" #
ValidationResult# 3
validationResult4 D
)D E
{ 	
foreach 
( 
var 
error 
in !
validationResult" 2
.2 3
Errors3 9
)9 :
{ 
NotifyError 
( 
error !
.! "
ErrorMessage" .
). /
;/ 0
} 
} 	
	protected 
void 
NotifyError "
(" #
string# )
mensagem* 2
)2 3
{ 	
	_notifier 
. 
Handle 
( 
new  
Notification! -
(- .
mensagem. 6
)6 7
)7 8
;8 9
}   	
	protected"" 
bool"" 
Validate"" 
<""  
TV""  "
,""" #
TE""$ &
>""& '
(""' (
TV""( *

validation""+ 5
,""5 6
TE""7 9
entity"": @
)""@ A
where""B G
TV""H J
:""K L
AbstractValidator""M ^
<""^ _
TE""_ a
>""a b
where""c h
TE""i k
:""l m
Entity""n t
{## 	
var$$ 
	validator$$ 
=$$ 

validation$$ &
.$$& '
Validate$$' /
($$/ 0
entity$$0 6
)$$6 7
;$$7 8
if&& 
(&& 
	validator&& 
.&& 
IsValid&& !
)&&! "
return&&# )
true&&* .
;&&. /
NotifyError(( 
((( 
	validator(( !
)((! "
;((" #
return** 
false** 
;** 
}++ 	
},, 
}-- åÅ
VD:\TI\git\v2\IHunger_API\IHunger\3 - Service\IHunger.Service\CategoryProductService.cs
	namespace 	
IHunger
 
. 
Service 
{ 
public 

class "
CategoryProductService '
:( )
BaseService* 5
,5 6#
ICategoryProductService7 N
{ 
private 
readonly &
ICategoryProductRepository 3&
_categoryProductRepository4 N
;N O
public "
CategoryProductService %
(% &
	INotifier 
notifier 
, &
ICategoryProductRepository &%
categoryProductRepository' @
)@ A
:B C
baseD H
(H I
notifierI Q
)Q R
{ 	&
_categoryProductRepository &
=' (%
categoryProductRepository) B
;B C
} 	
public 
async 
Task 
< 
CategoryProduct )
>) *
Create+ 1
(1 2
CategoryProduct2 A
categoryProductB Q
)Q R
{ 	
if 
( 
! 
Validate 
( 
new %
CategoryProductValidation 7
(7 8
)8 9
,9 :
categoryProduct; J
)J K
)K L
returnM S
nullT X
;X Y
var 
categoryProductBD !
=" #
await% *&
_categoryProductRepository+ E
. 
Search 
( 
x 
=> 
x 
. 
Name #
==$ &
categoryProduct' 6
.6 7
Name7 ;
); <
;< =
if!! 
(!! 
categoryProductBD!!  
!=!!! #
null!!$ (
&&!!) +
categoryProductBD!!, =
.!!= >
Any!!> A
(!!A B
)!!B C
)!!C D
{"" 
NotifyError## 
(## 
$str## J
)##J K
;##K L
return$$ 
await$$ 
Task$$ !
.$$! "

FromResult$$" ,
<$$, -
CategoryProduct$$- <
>$$< =
($$= >
null$$> B
)$$B C
;$$C D
}%% 
await'' &
_categoryProductRepository'' ,
.(( 
Add(( 
((( 
categoryProduct(( $
)(($ %
;((% &
if** 
(** 
await** &
_categoryProductRepository** /
.**/ 0
Commit**0 6
(**6 7
)**7 8
)**8 9
{++ 
return,, 
await,, 
Task,, !
.,,! "

FromResult,," ,
(,,, -
categoryProduct,,- <
),,< =
;,,= >
}-- 
NotifyError// 
(// 
$str// 0
)//0 1
;//1 2
return00 
await00 
Task00 
.00 

FromResult00 (
<00( )
CategoryProduct00) 8
>008 9
(009 :
null00: >
)00> ?
;00? @
}11 	
public33 
async33 
Task33 
<33 
List33 
<33 
CategoryProduct33 .
>33. /
>33/ 0
GetAll331 7
(337 8
)338 9
{44 	
return55 
await55 &
_categoryProductRepository55 3
.66 
GetAll66 
(66 
)66 
;66 
}77 	
public99 
async99 
Task99 
<99 
List99 
<99 
CategoryProduct99 .
>99. /
>99/ 0
GetAllWithFilter991 A
(99A B!
CategoryProductFilter99B W!
categoryProductFilter99X m
)99m n
{:: 	

Expression;; 
<;; 
Func;; 
<;; 
CategoryProduct;; +
,;;+ ,
bool;;- 1
>;;1 2
>;;2 3
filter;;4 :
=;;; <
null;;= A
;;;A B
Func<< 
<<< 

IQueryable<< 
<<< 
CategoryProduct<< +
><<+ ,
,<<, -
IOrderedQueryable<<. ?
<<<? @
CategoryProduct<<@ O
><<O P
><<P Q
ordeBy<<R X
=<<Y Z
null<<[ _
;<<_ `
if>> 
(>> 
!>> 
string>> 
.>> 
IsNullOrWhiteSpace>> *
(>>* +!
categoryProductFilter>>+ @
.>>@ A
Name>>A E
)>>E F
)>>F G
{?? 
if@@ 
(@@ 
filter@@ 
==@@ 
null@@ !
)@@! "
{AA 
filterBB 
=BB 
PredicateBuilderBB -
.BB- .
NewBB. 1
<BB1 2
CategoryProductBB2 A
>BBA B
(BBB C
trueBBC G
)BBG H
;BBH I
}CC 
filterEE 
=EE 
filterEE 
.EE  
AndEE  #
(EE# $
xEE$ %
=>EE& (
xEE) *
.EE* +
NameEE+ /
==EE0 2!
categoryProductFilterEE3 H
.EEH I
NameEEI M
||EEN P
xEEQ R
.EER S
NameEES W
.EEW X
ContainsEEX `
(EE` a!
categoryProductFilterEEa v
.EEv w
NameEEw {
)EE{ |
)EE| }
;EE} ~
}FF 
ifHH 
(HH 
!HH 
stringHH 
.HH 
IsNullOrWhiteSpaceHH *
(HH* +!
categoryProductFilterHH+ @
.HH@ A
DescriptionHHA L
)HHL M
)HHM N
{II 
ifJJ 
(JJ 
filterJJ 
==JJ 
nullJJ "
)JJ" #
{KK 
filterLL 
=LL 
PredicateBuilderLL -
.LL- .
NewLL. 1
<LL1 2
CategoryProductLL2 A
>LLA B
(LLB C
trueLLC G
)LLG H
;LLH I
}MM 
filterOO 
=OO 
filterOO 
.OO  
AndOO  #
(OO# $
xOO$ %
=>OO& (
xOO) *
.OO* +
DescriptionOO+ 6
==OO7 9!
categoryProductFilterOO: O
.OOO P
DescriptionOOP [
||OO\ ^
xOO_ `
.OO` a
NameOOa e
.OOe f
ContainsOOf n
(OOn o"
categoryProductFilter	OOo Ñ
.
OOÑ Ö
Description
OOÖ ê
)
OOê ë
)
OOë í
;
OOí ì
}PP 
ifRR 
(RR 
!RR 
stringRR 
.RR 
IsNullOrWhiteSpaceRR *
(RR* +!
categoryProductFilterRR+ @
.RR@ A
OrderRRA F
)RRF G
)RRG H
{SS 
switchTT 
(TT !
categoryProductFilterTT -
.TT- .
OrderTT. 3
)TT3 4
{UU 
caseVV 
$strVV 
:VV 
ordeByWW 
=WW  
xWW! "
=>WW# %
xWW& '
.WW' (
OrderByWW( /
(WW/ 0
nWW0 1
=>WW2 4
nWW5 6
.WW6 7
IdWW7 9
)WW9 :
;WW: ;
breakXX 
;XX 
caseYY 
$strYY 
:YY  
ordeByZZ 
=ZZ  
xZZ! "
=>ZZ# %
xZZ& '
.ZZ' (
OrderByZZ( /
(ZZ/ 0
nZZ0 1
=>ZZ2 4
nZZ5 6
.ZZ6 7
NameZZ7 ;
)ZZ; <
;ZZ< =
break[[ 
;[[ 
case\\ 
$str\\ &
:\\& '
ordeBy]] 
=]]  
x]]! "
=>]]# %
x]]& '
.]]' (
OrderBy]]( /
(]]/ 0
n]]0 1
=>]]2 4
n]]5 6
.]]6 7
Description]]7 B
)]]B C
;]]C D
break^^ 
;^^ 
case__ 
$str__ $
:__$ %
ordeBy`` 
=``  
x``! "
=>``# %
x``& '
.``' (
OrderBy``( /
(``/ 0
n``0 1
=>``2 4
n``5 6
.``6 7
	CreatedAt``7 @
)``@ A
;``A B
breakaa 
;aa 
casebb 
$strbb $
:bb$ %
ordeBycc 
=cc  
xcc! "
=>cc# %
xcc& '
.cc' (
OrderBycc( /
(cc/ 0
ncc0 1
=>cc2 4
ncc5 6
.cc6 7
	CreatedAtcc7 @
)cc@ A
;ccA B
breakdd 
;dd 
}ee 
}ff 
ifhh 
(hh !
categoryProductFilterhh $
.hh$ %
Idhh% '
!=hh( *
Guidhh+ /
.hh/ 0
Emptyhh0 5
)hh5 6
{ii 
ifjj 
(jj 
filterjj 
==jj 
nulljj "
)jj" #
{kk 
filterll 
=ll 
PredicateBuilderll -
.ll- .
Newll. 1
<ll1 2
CategoryProductll2 A
>llA B
(llB C
truellC G
)llG H
;llH I
}mm 
filteroo 
=oo 
filteroo 
.oo  
Andoo  #
(oo# $
xoo$ %
=>oo& (
xoo) *
.oo* +
Idoo+ -
==oo. 0!
categoryProductFilteroo1 F
.ooF G
IdooG I
)ooI J
;ooJ K
}pp 
ifrr 
(rr !
categoryProductFilterrr %
.rr% &
	CreatedAtrr& /
.rr/ 0
Yearrr0 4
>rr5 6
$numrr7 8
)rr8 9
{ss 
iftt 
(tt 
filtertt 
==tt 
nulltt "
)tt" #
{uu 
filtervv 
=vv 
PredicateBuildervv -
.vv- .
Newvv. 1
<vv1 2
CategoryProductvv2 A
>vvA B
(vvB C
truevvC G
)vvG H
;vvH I
}ww 
filteryy 
=yy 
filteryy 
.yy  
Andyy  #
(yy# $
xyy$ %
=>yy& (
xyy) *
.yy* +
Idyy+ -
==yy. 0!
categoryProductFilteryy1 F
.yyF G
IdyyG I
)yyI J
;yyJ K
}zz 
return|| 
await|| &
_categoryProductRepository|| 3
.}} 
Search}} 
(}} 
filter~~ 
,~~ 
ordeBy 
, #
categoryProductFilter
ÄÄ )
.
ÄÄ) *
PageSize
ÄÄ* 2
,
ÄÄ2 3#
categoryProductFilter
ÅÅ )
.
ÅÅ) *
	PageIndex
ÅÅ* 3
)
ÅÅ3 4
;
ÅÅ4 5
}
ÇÇ 	
public
ÑÑ 
async
ÑÑ 
Task
ÑÑ 
<
ÑÑ 
CategoryProduct
ÑÑ )
>
ÑÑ) *
GetById
ÑÑ+ 2
(
ÑÑ2 3
Guid
ÑÑ3 7
id
ÑÑ8 :
)
ÑÑ: ;
{
ÖÖ 	
return
ÜÜ 
await
ÜÜ (
_categoryProductRepository
ÜÜ 3
.
áá 
GetById
áá 
(
áá 
id
áá 
)
áá 
;
áá 
}
àà 	
public
ää 
async
ää 
Task
ää 
<
ää 
CategoryProduct
ää )
>
ää) *
Update
ää+ 1
(
ää1 2
CategoryProduct
ää2 A
categoryProduct
ääB Q
)
ääQ R
{
ãã 	
if
åå 
(
åå 
!
åå 
Validate
åå 
(
åå 
new
åå '
CategoryProductValidation
åå 7
(
åå7 8
)
åå8 9
,
åå9 :
categoryProduct
åå; J
)
ååJ K
)
ååK L
return
ååM S
null
ååT X
;
ååX Y
var
éé 
categoryProductDb
éé !
=
éé" #
await
éé$ )(
_categoryProductRepository
éé* D
.
èè 
GetById
èè 
(
èè 
categoryProduct
èè (
.
èè( )
Id
èè) +
)
èè+ ,
;
èè, -
if
ëë 
(
ëë 
categoryProductDb
ëë !
==
ëë" $
null
ëë% )
)
ëë) *
{
íí 
NotifyError
ìì 
(
ìì 
$str
ìì '
)
ìì' (
;
ìì( )
return
îî 
await
îî 
Task
îî !
.
îî! "

FromResult
îî" ,
<
îî, -
CategoryProduct
îî- <
>
îî< =
(
îî= >
null
îî> B
)
îîB C
;
îîC D
}
ïï 
if
óó 
(
óó 
categoryProductDb
óó !
.
óó! "
Name
óó" &
!=
óó' )
categoryProduct
óó* 9
.
óó9 :
Name
óó: >
)
óó> ?
{
òò 
categoryProductDb
ôô !
.
ôô! "
Name
ôô" &
=
ôô' (
categoryProduct
ôô) 8
.
ôô8 9
Name
ôô9 =
;
ôô= >
}
öö 
if
úú 
(
úú 
categoryProductDb
úú !
.
úú! "
Description
úú" -
!=
úú. 0
categoryProduct
úú1 @
.
úú@ A
Description
úúA L
)
úúL M
{
ùù 
categoryProductDb
ûû !
.
ûû! "
Description
ûû" -
=
ûû. /
categoryProduct
ûû0 ?
.
ûû? @
Description
ûû@ K
;
ûûK L
}
üü (
_categoryProductRepository
°° &
.
¢¢ 
Update
¢¢ 
(
¢¢ 
categoryProductDb
¢¢ *
)
¢¢* +
;
¢¢+ ,
if
§§ 
(
§§ 
await
§§ (
_categoryProductRepository
§§ 0
.
§§0 1
Commit
§§1 7
(
§§7 8
)
§§8 9
)
§§9 :
{
•• 
return
¶¶ 
await
¶¶ 
Task
¶¶ !
.
¶¶! "

FromResult
¶¶" ,
<
¶¶, -
CategoryProduct
¶¶- <
>
¶¶< =
(
¶¶= >
categoryProductDb
¶¶> O
)
¶¶O P
;
¶¶P Q
}
ßß 
NotifyError
©© 
(
©© 
$str
©© /
)
©©/ 0
;
©©0 1
return
™™ 
await
™™ 
Task
™™ 
.
™™ 

FromResult
™™ (
<
™™( )
CategoryProduct
™™) 8
>
™™8 9
(
™™9 :
null
™™: >
)
™™> ?
;
™™? @
}
´´ 	
public
≠≠ 
async
≠≠ 
Task
≠≠ 
<
≠≠ 
CategoryProduct
≠≠ )
>
≠≠) *
Delete
≠≠+ 1
(
≠≠1 2
Guid
≠≠2 6
id
≠≠7 9
)
≠≠9 :
{
ÆÆ 	
var
ØØ 
categoryProduct
ØØ 
=
ØØ  !
await
ØØ" '(
_categoryProductRepository
ØØ( B
.
∞∞ 
GetById
∞∞ 
(
∞∞ 
id
∞∞ 
)
∞∞ 
;
∞∞ 
if
≤≤ 
(
≤≤ 
categoryProduct
≤≤ 
==
≤≤ !
null
≤≤" &
)
≤≤& '
{
≥≥ 
NotifyError
¥¥ 
(
¥¥ 
$str
¥¥ '
)
¥¥' (
;
¥¥( )
return
µµ 
await
µµ 
Task
µµ !
.
µµ! "

FromResult
µµ" ,
<
µµ, -
CategoryProduct
µµ- <
>
µµ< =
(
µµ= >
null
µµ> B
)
µµB C
;
µµC D
}
∂∂ (
_categoryProductRepository
∏∏ &
.
ππ 
Remove
ππ 
(
ππ 
id
ππ 
)
ππ 
;
ππ 
if
ªª 
(
ªª 
await
ªª (
_categoryProductRepository
ªª 0
.
ªª0 1
Commit
ªª1 7
(
ªª7 8
)
ªª8 9
)
ªª9 :
{
ºº 
return
ΩΩ 
await
ΩΩ 
Task
ΩΩ !
.
ΩΩ! "

FromResult
ΩΩ" ,
(
ΩΩ, -
categoryProduct
ΩΩ- <
)
ΩΩ< =
;
ΩΩ= >
}
ææ 
NotifyError
¿¿ 
(
¿¿ 
$str
¿¿ /
)
¿¿/ 0
;
¿¿0 1
return
¡¡ 
await
¡¡ 
Task
¡¡ 
.
¡¡ 

FromResult
¡¡ (
<
¡¡( )
CategoryProduct
¡¡) 8
>
¡¡8 9
(
¡¡9 :
null
¡¡: >
)
¡¡> ?
;
¡¡? @
}
¬¬ 	
}
√√ 
}ƒƒ ”|
YD:\TI\git\v2\IHunger_API\IHunger\3 - Service\IHunger.Service\CategoryRestaurantService.cs
	namespace 	
IHunger
 
. 
Service 
{ 
public 

class %
CategoryRestaurantService *
:+ ,
BaseService- 8
,8 9&
ICategoryRestaurantService: T
{ 
private 
readonly )
ICategoryRestaurantRepository 6)
_categoryRestaurantRepository7 T
;T U
public %
CategoryRestaurantService (
(( ))
ICategoryRestaurantRepository )(
categoryRestaurantRepository* F
,F G
	INotifier 
notifier 
) 
:  !
base" &
(& '
notifier' /
)/ 0
{ 	)
_categoryRestaurantRepository )
=* +(
categoryRestaurantRepository, H
;H I
} 	
public 
async 
Task 
< 
CategoryRestaurant ,
>, -
Create. 4
(4 5
CategoryRestaurant5 G
categoryRestaurantH Z
)Z [
{ 	
if 
( 
! 
Validate 
( 
new (
CategoryRestaurantValidation :
(: ;
); <
,< =
categoryRestaurant> P
)P Q
)Q R
returnS Y
nullZ ^
;^ _
var  
categoryRestaurantDb $
=% &
await' ,)
_categoryRestaurantRepository- J
.   
Search   
(   
x   
=>   
x   
.   
Name   #
==  $ &
categoryRestaurant  ' 9
.  9 :
Name  : >
)  > ?
;  ? @
if"" 
(""  
categoryRestaurantDb"" $
!=""% '
null""( ,
&&""- / 
categoryRestaurantDb""0 D
.""D E
Any""E H
(""H I
)""I J
)""J K
{## 
NotifyError$$ 
($$ 
$str$$ M
)$$M N
;$$N O
return%% 
await%% 
Task%% !
.%%! "

FromResult%%" ,
<%%, -
CategoryRestaurant%%- ?
>%%? @
(%%@ A
null%%A E
)%%E F
;%%F G
}&& 
await(( )
_categoryRestaurantRepository(( /
.)) 
Add)) 
()) 
categoryRestaurant)) '
)))' (
;))( )
if++ 
(++ 
await++ )
_categoryRestaurantRepository++ 3
.++3 4
Commit++4 :
(++: ;
)++; <
)++< =
{,, 
return-- 
await-- 
Task-- !
.--! "

FromResult--" ,
(--, -
categoryRestaurant--- ?
)--? @
;--@ A
}.. 
NotifyError00 
(00 
$str00 0
)000 1
;001 2
return11 
await11 
Task11 
.11 

FromResult11 (
<11( )
CategoryRestaurant11) ;
>11; <
(11< =
null11= A
)11A B
;11B C
}22 	
public44 
async44 
Task44 
<44 
List44 
<44 
CategoryRestaurant44 1
>441 2
>442 3
GetAll444 :
(44: ;
)44; <
{55 	
return66 
await66 )
_categoryRestaurantRepository66 6
.77 
GetAll77 
(77 
)77 
;77 
}88 	
public:: 
async:: 
Task:: 
<:: 
List:: 
<:: 
CategoryRestaurant:: 1
>::1 2
>::2 3
GetAllWithFilter::4 D
(::D E$
CategoryRestaurantFilter::E ]$
CategoryRestaurantFilter::^ v
)::v w
{;; 	

Expression<< 
<<< 
Func<< 
<<< 
CategoryRestaurant<< .
,<<. /
bool<<0 4
><<4 5
><<5 6
filter<<7 =
=<<> ?
null<<@ D
;<<D E
Func== 
<== 

IQueryable== 
<== 
CategoryRestaurant== .
>==. /
,==/ 0
IOrderedQueryable==1 B
<==B C
CategoryRestaurant==C U
>==U V
>==V W
ordeBy==X ^
===_ `
null==a e
;==e f
if?? 
(?? 
!?? 
string?? 
.?? 
IsNullOrWhiteSpace?? *
(??* +$
CategoryRestaurantFilter??+ C
.??C D
Name??D H
)??H I
)??I J
{@@ 
ifAA 
(AA 
filterAA 
==AA 
nullAA "
)AA" #
{BB 
filterCC 
=CC 
PredicateBuilderCC -
.CC- .
NewCC. 1
<CC1 2
CategoryRestaurantCC2 D
>CCD E
(CCE F
trueCCF J
)CCJ K
;CCK L
}DD 
filterFF 
=FF 
filterFF 
.FF  
AndFF  #
(FF# $
xFF$ %
=>FF& (
xFF) *
.FF* +
NameFF+ /
==FF0 2$
CategoryRestaurantFilterFF3 K
.FFK L
NameFFL P
)FFP Q
;FFQ R
}GG 
ifII 
(II 
!II 
stringII 
.II 
IsNullOrWhiteSpaceII *
(II* +$
CategoryRestaurantFilterII+ C
.IIC D
DescriptionIID O
)IIO P
)IIP Q
{JJ 
ifKK 
(KK 
filterKK 
==KK 
nullKK "
)KK" #
{LL 
filterMM 
=MM 
PredicateBuilderMM -
.MM- .
NewMM. 1
<MM1 2
CategoryRestaurantMM2 D
>MMD E
(MME F
trueMMF J
)MMJ K
;MMK L
}NN 
filterPP 
=PP 
filterPP 
.PP  
AndPP  #
(PP# $
xPP$ %
=>PP& (
xPP) *
.PP* +
DescriptionPP+ 6
==PP7 9$
CategoryRestaurantFilterPP: R
.PPR S
DescriptionPPS ^
)PP^ _
;PP_ `
}QQ 
ifSS 
(SS 
!SS 
stringSS 
.SS 
IsNullOrWhiteSpaceSS *
(SS* +$
CategoryRestaurantFilterSS+ C
.SSC D
OrderSSD I
)SSI J
)SSJ K
{TT 
switchUU 
(UU $
CategoryRestaurantFilterUU 0
.UU0 1
OrderUU1 6
)UU6 7
{VV 
caseWW 
$strWW 
:WW 
ordeByXX 
=XX  
xXX! "
=>XX# %
xXX& '
.XX' (
OrderByXX( /
(XX/ 0
nXX0 1
=>XX2 4
nXX5 6
.XX6 7
IdXX7 9
)XX9 :
;XX: ;
breakYY 
;YY 
caseZZ 
$strZZ 
:ZZ  
ordeBy[[ 
=[[  
x[[! "
=>[[# %
x[[& '
.[[' (
OrderBy[[( /
([[/ 0
n[[0 1
=>[[2 4
n[[5 6
.[[6 7
Name[[7 ;
)[[; <
;[[< =
break\\ 
;\\ 
case]] 
$str]] &
:]]& '
ordeBy^^ 
=^^  
x^^! "
=>^^# %
x^^& '
.^^' (
OrderBy^^( /
(^^/ 0
n^^0 1
=>^^2 4
n^^5 6
.^^6 7
Description^^7 B
)^^B C
;^^C D
break__ 
;__ 
case`` 
$str`` $
:``$ %
ordeByaa 
=aa  
xaa! "
=>aa# %
xaa& '
.aa' (
OrderByaa( /
(aa/ 0
naa0 1
=>aa2 4
naa5 6
.aa6 7
	CreatedAtaa7 @
)aa@ A
;aaA B
breakbb 
;bb 
}cc 
}dd 
ifff 
(ff $
CategoryRestaurantFilterff (
.ff( )
Idff) +
!=ff, .
Guidff/ 3
.ff3 4
Emptyff4 9
)ff9 :
{gg 
ifhh 
(hh 
filterhh 
==hh 
nullhh "
)hh" #
{ii 
filterjj 
=jj 
PredicateBuilderjj -
.jj- .
Newjj. 1
<jj1 2
CategoryRestaurantjj2 D
>jjD E
(jjE F
truejjF J
)jjJ K
;jjK L
}kk 
filtermm 
=mm 
filtermm 
.mm  
Andmm  #
(mm# $
xmm$ %
=>mm& (
xmm) *
.mm* +
Idmm+ -
==mm. 0$
CategoryRestaurantFiltermm1 I
.mmI J
IdmmJ L
)mmL M
;mmM N
}nn 
ifpp 
(pp $
CategoryRestaurantFilterpp (
.pp( )
	CreatedAtpp) 2
.pp2 3
Yearpp3 7
>pp8 9
$numpp: ;
)pp; <
{qq 
ifrr 
(rr 
filterrr 
==rr 
nullrr "
)rr" #
{ss 
filtertt 
=tt 
PredicateBuildertt -
.tt- .
Newtt. 1
<tt1 2
CategoryRestauranttt2 D
>ttD E
(ttE F
truettF J
)ttJ K
;ttK L
}uu 
filterww 
=ww 
filterww 
.ww  
Andww  #
(ww# $
xww$ %
=>ww& (
xww) *
.ww* +
Idww+ -
==ww. 0$
CategoryRestaurantFilterww1 I
.wwI J
IdwwJ L
)wwL M
;wwM N
}xx 
returnzz 
awaitzz )
_categoryRestaurantRepositoryzz 6
.{{ 
Search{{ 
({{ 
filter|| 
,|| 
ordeBy}} 
,}} $
CategoryRestaurantFilter~~ ,
.~~, -
PageSize~~- 5
,~~5 6$
CategoryRestaurantFilter ,
., -
	PageIndex- 6
)6 7
;7 8
}
ÄÄ 	
public
ÇÇ 
async
ÇÇ 
Task
ÇÇ 
<
ÇÇ  
CategoryRestaurant
ÇÇ ,
>
ÇÇ, -
GetById
ÇÇ. 5
(
ÇÇ5 6
Guid
ÇÇ6 :
id
ÇÇ; =
)
ÇÇ= >
{
ÉÉ 	
return
ÑÑ 
await
ÑÑ +
_categoryRestaurantRepository
ÑÑ 6
.
ÖÖ 
GetById
ÖÖ 
(
ÖÖ 
id
ÖÖ 
)
ÖÖ 
;
ÖÖ 
}
ÜÜ 	
public
àà 
async
àà 
Task
àà 
<
àà  
CategoryRestaurant
àà ,
>
àà, -
Update
àà. 4
(
àà4 5 
CategoryRestaurant
àà5 G 
categoryRestaurant
ààH Z
)
ààZ [
{
ââ 	
if
ää 
(
ää 
!
ää 
Validate
ää 
(
ää 
new
ää *
CategoryRestaurantValidation
ää :
(
ää: ;
)
ää; <
,
ää< = 
categoryRestaurant
ää> P
)
ääP Q
)
ääQ R
return
ääS Y
null
ääZ ^
;
ää^ _
var
åå "
categoryRestaurantDb
åå $
=
åå% &
await
åå' ,+
_categoryRestaurantRepository
åå- J
.
çç 
GetById
çç 
(
çç  
categoryRestaurant
çç +
.
çç+ ,
Id
çç, .
)
çç. /
;
çç/ 0
if
èè 
(
èè "
categoryRestaurantDb
èè $
==
èè% '
null
èè( ,
)
èè, -
{
êê 
NotifyError
ëë 
(
ëë 
$str
ëë '
)
ëë' (
;
ëë( )
return
íí 
await
íí 
Task
íí !
.
íí! "

FromResult
íí" ,
<
íí, - 
CategoryRestaurant
íí- ?
>
íí? @
(
íí@ A
null
ííA E
)
ííE F
;
ííF G
}
ìì 
if
ïï 
(
ïï "
categoryRestaurantDb
ïï #
.
ïï# $
Name
ïï$ (
!=
ïï) + 
categoryRestaurant
ïï, >
.
ïï> ?
Name
ïï? C
)
ïïC D
{
ññ "
categoryRestaurantDb
óó $
.
óó$ %
Name
óó% )
=
óó* + 
categoryRestaurant
óó, >
.
óó> ?
Name
óó? C
;
óóC D
}
òò 
if
öö 
(
öö "
categoryRestaurantDb
öö $
.
öö$ %
Description
öö% 0
!=
öö1 3 
categoryRestaurant
öö4 F
.
ööF G
Description
ööG R
)
ööR S
{
õõ "
categoryRestaurantDb
úú $
.
úú$ %
Description
úú% 0
=
úú1 2 
categoryRestaurant
úú3 E
.
úúE F
Description
úúF Q
;
úúQ R
}
ùù +
_categoryRestaurantRepository
üü )
.
†† 
Update
†† 
(
†† "
categoryRestaurantDb
†† ,
)
††, -
;
††- .
if
¢¢ 
(
¢¢ 
await
¢¢ +
_categoryRestaurantRepository
¢¢ 3
.
¢¢3 4
Commit
¢¢4 :
(
¢¢: ;
)
¢¢; <
)
¢¢< =
{
££ 
return
§§ 
await
§§ 
Task
§§ !
.
§§! "

FromResult
§§" ,
(
§§, -"
categoryRestaurantDb
§§- A
)
§§A B
;
§§B C
}
•• 
NotifyError
ßß 
(
ßß 
$str
ßß /
)
ßß/ 0
;
ßß0 1
return
®® 
await
®® 
Task
®® 
.
®® 

FromResult
®® (
<
®®( ) 
CategoryRestaurant
®®) ;
>
®®; <
(
®®< =
null
®®= A
)
®®A B
;
®®B C
}
©© 	
public
´´ 
async
´´ 
Task
´´ 
<
´´  
CategoryRestaurant
´´ ,
>
´´, -
Delete
´´. 4
(
´´4 5
Guid
´´5 9
id
´´: <
)
´´< =
{
¨¨ 	
var
≠≠ "
categoryRestaurantDb
≠≠ $
=
≠≠% &
await
≠≠' ,+
_categoryRestaurantRepository
≠≠- J
.
ÆÆ 
GetById
ÆÆ 
(
ÆÆ 
id
ÆÆ 
)
ÆÆ 
;
ÆÆ 
if
∞∞ 
(
∞∞ "
categoryRestaurantDb
∞∞ $
==
∞∞% '
null
∞∞( ,
)
∞∞, -
{
±± 
NotifyError
≤≤ 
(
≤≤ 
$str
≤≤ '
)
≤≤' (
;
≤≤( )
return
≥≥ 
await
≥≥ 
Task
≥≥ !
.
≥≥! "

FromResult
≥≥" ,
<
≥≥, - 
CategoryRestaurant
≥≥- ?
>
≥≥? @
(
≥≥@ A
null
≥≥A E
)
≥≥E F
;
≥≥F G
}
¥¥ +
_categoryRestaurantRepository
∂∂ )
.
∑∑ 
Remove
∑∑ 
(
∑∑ 
id
∑∑ 
)
∑∑ 
;
∑∑ 
if
ππ 
(
ππ 
await
ππ +
_categoryRestaurantRepository
ππ 3
.
ππ3 4
Commit
ππ4 :
(
ππ: ;
)
ππ; <
)
ππ< =
{
∫∫ 
return
ªª 
await
ªª 
Task
ªª !
.
ªª! "

FromResult
ªª" ,
(
ªª, -"
categoryRestaurantDb
ªª- A
)
ªªA B
;
ªªB C
}
ºº 
NotifyError
ææ 
(
ææ 
$str
ææ /
)
ææ/ 0
;
ææ0 1
return
øø 
await
øø 
Task
øø 
.
øø 

FromResult
øø (
<
øø( ) 
CategoryRestaurant
øø) ;
>
øø; <
(
øø< =
null
øø= A
)
øøA B
;
øøB C
}
¿¿ 	
}
¡¡ 
}¬¬ ùD
ND:\TI\git\v2\IHunger_API\IHunger\3 - Service\IHunger.Service\CommentService.cs
	namespace 	
IHunger
 
. 
Service 
{ 
public 

class 
CommentService 
:  !
BaseService" -
,- .
ICommentService/ >
{ 
private 
readonly !
IRestaurantRepository .!
_restaurantRepository/ D
;D E
private 
readonly 
ICommentRepository +
_commentRepository, >
;> ?
public 
CommentService 
( !
IRestaurantRepository ! 
restaurantRepository" 6
,6 7
ICommentRepository 
commentRepository 0
,0 1
	INotifier 
notifier 
) 
:  !
base" &
(& '
notifier' /
)/ 0
{ 	!
_restaurantRepository !
=" # 
restaurantRepository$ 8
;8 9
_commentRepository 
=  
commentRepository! 2
;2 3
} 	
public 
async 
Task 
< 
Comment !
>! "
Create# )
() *
Guid* .
idRestaurant/ ;
,; <
Comment= D
commentE L
)L M
{ 	
if 
( 
! 
Validate 
( 
new 
CommentValidation /
(/ 0
)0 1
,1 2
comment3 :
): ;
); <
return= C
nullD H
;H I
var 
restaurantBD 
= 
await $!
_restaurantRepository% :
.   
GetById   
(   
idRestaurant   %
)  % &
;  & '
if"" 
("" 
restaurantBD"" 
=="" 
null""  $
)""$ %
{## 
NotifyError$$ 
($$ 
$str$$ 4
)$$4 5
;$$5 6
return%% 
await%% 
Task%% !
.%%! "

FromResult%%" ,
<%%, -
Comment%%- 4
>%%4 5
(%%5 6
null%%6 :
)%%: ;
;%%; <
}&& 
await(( 
_commentRepository(( $
.)) 
Add)) 
()) 
comment)) 
))) 
;)) 
if++ 
(++ 
await++ 
_commentRepository++ (
.++( )
Commit++) /
(++/ 0
)++0 1
)++1 2
{,, 
return-- 
await-- 
Task-- !
.--! "

FromResult--" ,
(--, -
comment--- 4
)--4 5
;--5 6
}.. 
NotifyError00 
(00 
$str00 0
)000 1
;001 2
return11 
await11 
Task11 
.11 

FromResult11 (
<11( )
Comment11) 0
>110 1
(111 2
null112 6
)116 7
;117 8
}22 	
public44 
async44 
Task44 
<44 
Comment44 !
>44! "
GetById44# *
(44* +
Guid44+ /
idRestaurant440 <
,44< =
Guid44> B
	idComment44C L
)44L M
{55 	
return66 
await66 
_commentRepository66 +
.77 
GetById77 
(77 
idRestaurant77 %
,77% &
	idComment77' 0
)770 1
;771 2
}88 	
public:: 
async:: 
Task:: 
<:: 
List:: 
<:: 
Comment:: &
>::& '
>::' (
GetAll::) /
(::/ 0
Guid::0 4
idRestaurant::5 A
)::A B
{;; 	
return<< 
await<< 
_commentRepository<< +
.== 
GetAll== 
(== 
idRestaurant== $
)==$ %
;==% &
}>> 	
public@@ 
async@@ 
Task@@ 
<@@ 
Comment@@ !
>@@! "
Update@@# )
(@@) *
Guid@@* .
idRestaurant@@/ ;
,@@; <
Guid@@= A
	idComment@@B K
,@@K L
Comment@@M T
comment@@U \
)@@\ ]
{AA 	
ifBB 
(BB 
!BB 
ValidateBB 
(BB 
newBB 
CommentValidationBB /
(BB/ 0
)BB0 1
,BB1 2
commentBB3 :
)BB: ;
)BB; <
returnBB= C
nullBBD H
;BBH I
varDD 
	commentDbDD 
=DD 
awaitDD !
_commentRepositoryDD" 4
.EE 
GetByIdEE 
(EE 
idRestaurantEE %
,EE% &
	idCommentEE' 0
)EE0 1
;EE1 2
ifGG 
(GG 
	commentDbGG 
==GG 
nullGG !
)GG! "
{HH 
NotifyErrorII 
(II 
$strII '
)II' (
;II( )
returnJJ 
awaitJJ 
TaskJJ !
.JJ! "

FromResultJJ" ,
<JJ, -
CommentJJ- 4
>JJ4 5
(JJ5 6
nullJJ6 :
)JJ: ;
;JJ; <
}KK 
ifMM 
(MM 
	commentDbMM 
.MM 
StartsMM  
!=MM! #
commentMM$ +
.MM+ ,
StartsMM, 2
)MM2 3
{NN 
	commentDbOO 
.OO 
StartsOO  
=OO! "
commentOO# *
.OO* +
StartsOO+ 1
;OO1 2
}PP 
ifRR 
(RR 
	commentDbRR 
.RR 
TextRR 
!=RR !
commentRR" )
.RR) *
TextRR* .
)RR. /
{SS 
	commentDbTT 
.TT 
TextTT 
=TT  
commentTT! (
.TT( )
TextTT) -
;TT- .
}UU 
_commentRepositoryXX 
.YY 
UpdateYY 
(YY 
	commentDbYY !
)YY! "
;YY" #
if[[ 
([[ 
await[[ 
_commentRepository[[ (
.[[( )
Commit[[) /
([[/ 0
)[[0 1
)[[1 2
{\\ 
return]] 
await]] 
Task]] !
.]]! "

FromResult]]" ,
(]], -
	commentDb]]- 6
)]]6 7
;]]7 8
}^^ 
NotifyError`` 
(`` 
$str`` /
)``/ 0
;``0 1
returnaa 
awaitaa 
Taskaa 
.aa 

FromResultaa (
<aa( )
Commentaa) 0
>aa0 1
(aa1 2
nullaa2 6
)aa6 7
;aa7 8
}bb 	
publicdd 
asyncdd 
Taskdd 
<dd 
Commentdd !
>dd! "
Deletedd# )
(dd) *
Guiddd* .
idRestaurantdd/ ;
,dd; <
Guiddd= A
	idCommentddB K
)ddK L
{ee 	
varff 
commentff 
=ff 
awaitff 
_commentRepositoryff  2
.gg 
GetByIdgg 
(gg 
idRestaurantgg %
,gg% &
	idCommentgg' 0
)gg0 1
;gg1 2
ifii 
(ii 
commentii 
==ii 
nullii 
)ii  
{jj 
NotifyErrorkk 
(kk 
$strkk '
)kk' (
;kk( )
returnll 
awaitll 
Taskll !
.ll! "

FromResultll" ,
<ll, -
Commentll- 4
>ll4 5
(ll5 6
nullll6 :
)ll: ;
;ll; <
}mm 
_commentRepositoryoo 
.pp 
Removepp 
(pp 
	idCommentpp !
)pp! "
;pp" #
ifrr 
(rr 
awaitrr 
_commentRepositoryrr (
.rr( )
Commitrr) /
(rr/ 0
)rr0 1
)rr1 2
{ss 
returntt 
awaittt 
Tasktt !
.tt! "

FromResulttt" ,
(tt, -
commenttt- 4
)tt4 5
;tt5 6
}uu 
NotifyErrorww 
(ww 
$strww /
)ww/ 0
;ww0 1
returnxx 
awaitxx 
Taskxx 
.xx 

FromResultxx (
<xx( )
Commentxx) 0
>xx0 1
(xx1 2
nullxx2 6
)xx6 7
;xx7 8
}yy 	
}zz 
}{{ ÜH
MD:\TI\git\v2\IHunger_API\IHunger\3 - Service\IHunger.Service\CouponService.cs
	namespace 	
IHunger
 
. 
Service 
{ 
public 

class 
CouponService 
:  
BaseService! ,
,, -
ICouponService. <
{ 
private 
readonly 
ICouponRepository *
_couponRepository+ <
;< =
public 
CouponService 
( 
ICouponRepository 
couponRepository .
,. /
	INotifier 
notifier 
) 
:  !
base" &
(& '
notifier' /
)/ 0
{ 	
_couponRepository 
= 
couponRepository  0
;0 1
} 	
public 
async 
Task 
< 
Coupon  
>  !
Create" (
(( )
Coupon) /
coupon0 6
)6 7
{ 	
if 
( 
! 
Validate 
( 
new 
CouponValidation .
(. /
)/ 0
,0 1
coupon2 8
)8 9
)9 :
return; A
nullB F
;F G
var 
coupons 
= 
await 
_couponRepository  1
. 
Search 
( 
x 
=> 
x 
. 
Code #
==$ &
coupon' -
.- .
Code. 2
&&3 5
x6 7
.7 8
ExpireAt8 @
<A B
DateTimeC K
.K L
NowL O
)O P
;P Q
if   
(   
coupons   
!=   
null   
&&    "
coupons  # *
.  * +
Any  + .
(  . /
)  / 0
)  0 1
{!! 
NotifyError"" 
("" 
$str"" L
)""L M
;""M N
return## 
await## 
Task## !
.##! "

FromResult##" ,
<##, -
Coupon##- 3
>##3 4
(##4 5
null##5 9
)##9 :
;##: ;
}$$ 
await&& 
_couponRepository&& #
.'' 
Add'' 
('' 
coupon'' 
)'' 
;'' 
if)) 
()) 
await)) 
_couponRepository)) '
.))' (
Commit))( .
()). /
)))/ 0
)))0 1
{** 
return++ 
await++ 
Task++ !
.++! "

FromResult++" ,
(++, -
coupon++- 3
)++3 4
;++4 5
},, 
NotifyError.. 
(.. 
$str.. 0
)..0 1
;..1 2
return// 
await// 
Task// 
.// 

FromResult// (
<//( )
Coupon//) /
>/// 0
(//0 1
null//1 5
)//5 6
;//6 7
}00 	
public22 
async22 
Task22 
<22 
List22 
<22 
Coupon22 %
>22% &
>22& '
GetAll22( .
(22. /
bool22/ 3
ative224 9
=22: ;
true22< @
)22@ A
{33 	
if44 
(44 
ative44 
)44 
{55 
return66 
(66 
List66 
<66 
Coupon66 #
>66# $
)66$ %
await66& +
_couponRepository66, =
.77 
Find77 
(77 
x77 
=>77 
x77 
.77 
ExpireAt77 %
>77& '
DateTime77( 0
.770 1
Now771 4
)774 5
;775 6
}88 
return:: 
await:: 
_couponRepository:: *
.;; 
GetAll;; 
(;; 
);; 
;;; 
}<< 	
public>> 
async>> 
Task>> 
<>> 
Coupon>>  
>>>  !
GetById>>" )
(>>) *
Guid>>* .
id>>/ 1
)>>1 2
{?? 	
return@@ 
await@@ 
_couponRepository@@ *
.AA 
GetByIdAA 
(AA 
idAA 
)AA 
;AA 
}BB 	
publicDD 
asyncDD 
TaskDD 
<DD 
CouponDD  
>DD  !
UpdateDD" (
(DD( )
CouponDD) /
couponDD0 6
)DD6 7
{EE 	
ifFF 
(FF 
!FF 
ValidateFF 
(FF 
newFF 
CouponValidationFF .
(FF. /
)FF/ 0
,FF0 1
couponFF2 8
)FF8 9
)FF9 :
returnFF; A
nullFFB F
;FFF G
varHH 
couponDbHH 
=HH 
awaitHH  
_couponRepositoryHH! 2
.II 
GetByIdII 
(II 
couponII 
.II  
IdII  "
)II" #
;II# $
ifKK 
(KK 
couponDbKK 
==KK 
nullKK  
)KK  !
{LL 
NotifyErrorMM 
(MM 
$strMM '
)MM' (
;MM( )
returnNN 
awaitNN 
TaskNN !
.NN! "

FromResultNN" ,
<NN, -
CouponNN- 3
>NN3 4
(NN4 5
nullNN5 9
)NN9 :
;NN: ;
}OO 
ifQQ 
(QQ 
couponDbQQ 
.QQ 
CodeQQ 
!=QQ  
couponDbQQ! )
.QQ) *
CodeQQ* .
)QQ. /
{RR 
couponDbSS 
.SS 
CodeSS 
=SS 
couponDbSS  (
.SS( )
CodeSS) -
;SS- .
}TT 
ifVV 
(VV 
couponDbVV 
.VV 
ExpireAtVV !
!=VV" $
couponDbVV% -
.VV- .
ExpireAtVV. 6
)VV6 7
{WW 
couponDbXX 
.XX 
ExpireAtXX !
=XX" #
couponDbXX$ ,
.XX, -
ExpireAtXX- 5
;XX5 6
}YY 
if[[ 
([[ 
couponDb[[ 
.[[ 
Value[[ 
!=[[ !
couponDb[[" *
.[[* +
Value[[+ 0
)[[0 1
{\\ 
couponDb]] 
.]] 
Value]] 
=]]  
couponDb]]! )
.]]) *
Value]]* /
;]]/ 0
}^^ 
_couponRepository`` 
.aa 
Updateaa 
(aa 
couponDbaa !
)aa! "
;aa" #
ifcc 
(cc 
awaitcc 
_couponRepositorycc '
.cc' (
Commitcc( .
(cc. /
)cc/ 0
)cc0 1
{dd 
returnee 
awaitee 
Taskee !
.ee! "

FromResultee" ,
<ee, -
Couponee- 3
>ee3 4
(ee4 5
couponDbee5 =
)ee= >
;ee> ?
}ff 
NotifyErrorhh 
(hh 
$strhh /
)hh/ 0
;hh0 1
returnii 
awaitii 
Taskii 
.ii 

FromResultii (
<ii( )
Couponii) /
>ii/ 0
(ii0 1
nullii1 5
)ii5 6
;ii6 7
}jj 	
publicll 
asyncll 
Taskll 
<ll 
Couponll  
>ll  !
Deletell" (
(ll( )
Guidll) -
idll. 0
)ll0 1
{mm 	
varnn 
couponnn 
=nn 
awaitnn 
_couponRepositorynn 0
.oo 
GetByIdoo 
(oo 
idoo 
)oo 
;oo 
ifqq 
(qq 
couponqq 
==qq 
nullqq 
)qq 
{rr 
NotifyErrorss 
(ss 
$strss '
)ss' (
;ss( )
returntt 
awaittt 
Tasktt !
.tt! "

FromResulttt" ,
<tt, -
Coupontt- 3
>tt3 4
(tt4 5
nulltt5 9
)tt9 :
;tt: ;
}uu 
_couponRepositoryww 
.xx 
Removexx 
(xx 
idxx 
)xx 
;xx 
ifzz 
(zz 
awaitzz 
_couponRepositoryzz '
.zz' (
Commitzz( .
(zz. /
)zz/ 0
)zz0 1
{{{ 
return|| 
await|| 
Task|| !
.||! "

FromResult||" ,
(||, -
coupon||- 3
)||3 4
;||4 5
}}} 
NotifyError 
( 
$str /
)/ 0
;0 1
return
ÄÄ 
await
ÄÄ 
Task
ÄÄ 
.
ÄÄ 

FromResult
ÄÄ (
<
ÄÄ( )
Coupon
ÄÄ) /
>
ÄÄ/ 0
(
ÄÄ0 1
null
ÄÄ1 5
)
ÄÄ5 6
;
ÄÄ6 7
}
ÅÅ 	
}
ÇÇ 
}ÉÉ º
KD:\TI\git\v2\IHunger_API\IHunger\3 - Service\IHunger.Service\ItemService.cs
	namespace 	
IHunger
 
. 
Service 
{ 
public 

class 
ItemService 
: 
IItemService +
{		 
}

 
} ˙
LD:\TI\git\v2\IHunger_API\IHunger\3 - Service\IHunger.Service\OrderService.cs
	namespace 	
IHunger
 
. 
Service 
{ 
public 

class 
OrderService 
: 
BaseService  +
,+ ,
IOrderService- :
{ 
private 
readonly 
IOrderRepository )
_orderRepository* :
;: ;
public 
OrderService 
( 
IOrderRepository 
orderRepository ,
,, -
	INotifier 
notifier 
) 
:  !
base 
( 
notifier 
) 
{ 	
_orderRepository 
= 
orderRepository .
;. /
} 	
public 
Task 
< 
Order 
> 
Create !
(! "
Order" '
order( -
)- .
{ 	
throw 
new #
NotImplementedException -
(- .
). /
;/ 0
} 	
public 
Task 
< 
Order 
> 
Delete !
(! "
Guid" &
id' )
)) *
{ 	
throw   
new   #
NotImplementedException   -
(  - .
)  . /
;  / 0
}!! 	
public## 
Task## 
<## 
List## 
<## 
Order## 
>## 
>##  
GetAllWithFilter##! 1
(##1 2
OrderFilter##2 =
orderFilter##> I
)##I J
{$$ 	
throw%% 
new%% #
NotImplementedException%% -
(%%- .
)%%. /
;%%/ 0
}&& 	
public(( 
Task(( 
<(( 
Order(( 
>(( 
GetById(( "
(((" #
Guid((# '
id((( *
)((* +
{)) 	
throw** 
new** #
NotImplementedException** -
(**- .
)**. /
;**/ 0
}++ 	
public-- 
Task-- 
<-- 
Order-- 
>-- 
Update-- !
(--! "
Order--" '
order--( -
)--- .
{.. 	
throw// 
new// #
NotImplementedException// -
(//- .
)//. /
;/// 0
}00 	
}11 
}22 ¬
RD:\TI\git\v2\IHunger_API\IHunger\3 - Service\IHunger.Service\OrderStatusService.cs
	namespace

 	
IHunger


 
.

 
Service

 
{ 
public 

class 
OrderStatusService #
:$ %
BaseService& 1
,1 2
IOrderStatusService3 F
{ 
private 
readonly "
IOrderStatusRepository /"
_orderStatusRepository0 F
;F G
public 
OrderStatusService !
(! ""
IOrderStatusRepository "!
orderStatusRepository# 8
,8 9
	INotifier 
notifier 
) 
:  !
base" &
(& '
notifier' /
)/ 0
{ 	"
_orderStatusRepository "
=# $!
orderStatusRepository% :
;: ;
} 	
public 
async 
Task 
< 
List 
< 
OrderStatus *
>* +
>+ ,
GetAll- 3
(3 4
)4 5
{ 	
return 
await "
_orderStatusRepository /
. 
GetAll 
( 
) 
; 
} 	
public 
async 
Task 
< 
OrderStatus %
>% &
GetById' .
(. /
Guid/ 3
id4 6
)6 7
{ 	
return 
await "
_orderStatusRepository /
.   
GetById   
(   
id   
)   
;   
}!! 	
}## 
}$$ æŒ
ND:\TI\git\v2\IHunger_API\IHunger\3 - Service\IHunger.Service\ProductService.cs
	namespace 	
IHunger
 
. 
Service 
{ 
public 

class 
ProductService 
:  !
BaseService" -
,- .
IProductService/ >
{ 
private 
readonly !
IRestaurantRepository .!
_restaurantRepository/ D
;D E
private 
readonly 
IProductRepository +
_productRepository, >
;> ?
private 
readonly &
ICategoryProductRepository 3&
_categoryProductRepository4 N
;N O
public 
ProductService 
( !
IRestaurantRepository ! 
restaurantRepository" 6
,6 7
IProductRepository 
productRepository 0
,0 1&
ICategoryProductRepository &%
categoryProductRepository' @
,@ A
	INotifier 
notifier 
) 
:  !
base" &
(& '
notifier' /
)/ 0
{ 	!
_restaurantRepository !
=" # 
restaurantRepository$ 8
;8 9
_productRepository 
=  
productRepository! 2
;2 3&
_categoryProductRepository &
=' (%
categoryProductRepository) B
;B C
}   	
public"" 
async"" 
Task"" 
<"" 
Product"" !
>""! "
Create""# )
("") *
Product""* 1
product""2 9
)""9 :
{## 	
if$$ 
($$ 
!$$ 
Validate$$ 
($$ 
new$$ 
ProductValidation$$ /
($$/ 0
)$$0 1
,$$1 2
product$$3 :
)$$: ;
)$$; <
return$$= C
null$$D H
;$$H I
var&& 

restaurant&& 
=&& 
await&& "!
_restaurantRepository&&# 8
.'' 
GetById'' 
('' 
product''  
.''  !
IdRestaurant''! -
)''- .
;''. /
if)) 
()) 

restaurant)) 
==)) 
null)) "
)))" #
{** 
NotifyError++ 
(++ 
$str++ 3
)++3 4
;++4 5
return,, 
await,, 
Task,, !
.,,! "

FromResult,," ,
<,,, -
Product,,- 4
>,,4 5
(,,5 6
null,,6 :
),,: ;
;,,; <
}-- 
var// 
categoryProduct// 
=//  !
await//" '&
_categoryProductRepository//( B
.00 
GetById00 
(00 
product00  
.00  !
IdCategoryProduct00! 2
)002 3
;003 4
if22 
(22 
categoryProduct22 
==22  "
null22# '
)22' (
{33 
NotifyError44 
(44 
$str44 8
)448 9
;449 :
return55 
await55 
Task55 !
.55! "

FromResult55" ,
<55, -
Product55- 4
>554 5
(555 6
null556 :
)55: ;
;55; <
}66 
await88 
_productRepository88 $
.99 
Add99 
(99 
product99 
)99 
;99 
if;; 
(;; 
await;; 
_productRepository;; (
.;;( )
Commit;;) /
(;;/ 0
);;0 1
);;1 2
{<< 
return== 
await== 
Task== !
.==! "

FromResult==" ,
(==, -
product==- 4
)==4 5
;==5 6
}>> 
NotifyError@@ 
(@@ 
$str@@ 0
)@@0 1
;@@1 2
returnAA 
awaitAA 
TaskAA 
.AA 

FromResultAA (
<AA( )
ProductAA) 0
>AA0 1
(AA1 2
nullAA2 6
)AA6 7
;AA7 8
}BB 	
publicDD 
asyncDD 
TaskDD 
<DD 
ListDD 
<DD 
ProductDD &
>DD& '
>DD' (
GetAllWithFilterDD) 9
(DD9 :
ProductFilterDD: G
productFilterDDH U
)DDU V
{EE 	

ExpressionFF 
<FF 
FuncFF 
<FF 
ProductFF #
,FF# $
boolFF% )
>FF) *
>FF* +
filterFF, 2
=FF3 4
nullFF5 9
;FF9 :
FuncGG 
<GG 

IQueryableGG 
<GG 
ProductGG #
>GG# $
,GG$ %
IOrderedQueryableGG& 7
<GG7 8
ProductGG8 ?
>GG? @
>GG@ A
ordeByGGB H
=GGI J
nullGGK O
;GGO P
ifII 
(II 
!II 
stringII 
.II 
IsNullOrWhiteSpaceII *
(II* +
productFilterII+ 8
.II8 9
NameII9 =
)II= >
)II> ?
{JJ 
ifKK 
(KK 
filterKK 
==KK 
nullKK "
)KK" #
{LL 
filterMM 
=MM 
PredicateBuilderMM -
.MM- .
NewMM. 1
<MM1 2
ProductMM2 9
>MM9 :
(MM: ;
trueMM; ?
)MM? @
;MM@ A
}NN 
filterPP 
=PP 
filterPP 
.PP  
AndPP  #
(PP# $
xPP$ %
=>PP& (
xPP) *
.PP* +
NamePP+ /
==PP0 2
productFilterPP3 @
.PP@ A
NamePPA E
)PPE F
;PPF G
}QQ 
ifSS 
(SS 
productFilterSS 
.SS 
IdSS  
!=SS! #
GuidSS$ (
.SS( )
EmptySS) .
)SS. /
{TT 
ifUU 
(UU 
filterUU 
==UU 
nullUU "
)UU" #
{VV 
filterWW 
=WW 
PredicateBuilderWW -
.WW- .
NewWW. 1
<WW1 2
ProductWW2 9
>WW9 :
(WW: ;
trueWW; ?
)WW? @
;WW@ A
}XX 
filterZZ 
=ZZ 
filterZZ 
.ZZ  
AndZZ  #
(ZZ# $
xZZ$ %
=>ZZ& (
xZZ) *
.ZZ* +
IdZZ+ -
==ZZ. 0
productFilterZZ1 >
.ZZ> ?
IdZZ? A
)ZZA B
;ZZB C
}[[ 
if]] 
(]] 
productFilter]] 
.]] 
IdCategoryProduct]] /
!=]]0 2
Guid]]3 7
.]]7 8
Empty]]8 =
)]]= >
{^^ 
if__ 
(__ 
filter__ 
==__ 
null__ "
)__" #
{`` 
filteraa 
=aa 
PredicateBuilderaa -
.aa- .
Newaa. 1
<aa1 2
Productaa2 9
>aa9 :
(aa: ;
trueaa; ?
)aa? @
;aa@ A
}bb 
filterdd 
=dd 
filterdd 
.dd  
Anddd  #
(dd# $
xdd$ %
=>dd& (
xdd) *
.dd* +
CategoryProductdd+ :
.dd: ;
Iddd; =
==dd> @
productFilterddA N
.ddN O
IdCategoryProductddO `
)dd` a
;dda b
}ee 
ifgg 
(gg 
!gg 
stringgg 
.gg 
IsNullOrWhiteSpacegg *
(gg* +
productFiltergg+ 8
.gg8 9
Descriptiongg9 D
)ggD E
)ggE F
{hh 
ifii 
(ii 
filterii 
==ii 
nullii "
)ii" #
{jj 
filterkk 
=kk 
PredicateBuilderkk -
.kk- .
Newkk. 1
<kk1 2
Productkk2 9
>kk9 :
(kk: ;
truekk; ?
)kk? @
;kk@ A
}ll 
filternn 
=nn 
filternn 
.nn  
Andnn  #
(nn# $
xnn$ %
=>nn& (
xnn) *
.nn* +
Descriptionnn+ 6
==nn7 9
productFilternn: G
.nnG H
DescriptionnnH S
)nnS T
;nnT U
}oo 
ifqq 
(qq 
productFilterqq 
.qq 
Kosherqq $
)qq$ %
{rr 
ifss 
(ss 
filterss 
==ss 
nullss "
)ss" #
{tt 
filteruu 
=uu 
PredicateBuilderuu -
.uu- .
Newuu. 1
<uu1 2
Productuu2 9
>uu9 :
(uu: ;
trueuu; ?
)uu? @
;uu@ A
}vv 
filterxx 
=xx 
filterxx 
.xx  
Andxx  #
(xx# $
xxx$ %
=>xx& (
xxx) *
.xx* +
Kosherxx+ 1
==xx2 4
productFilterxx5 B
.xxB C
KosherxxC I
)xxI J
;xxJ K
}yy 
if{{ 
({{ 
productFilter{{ 
.{{ 
Vegan{{ #
){{# $
{|| 
if}} 
(}} 
filter}} 
==}} 
null}} "
)}}" #
{~~ 
filter 
= 
PredicateBuilder -
.- .
New. 1
<1 2
Product2 9
>9 :
(: ;
true; ?
)? @
;@ A
}
ÄÄ 
filter
ÇÇ 
=
ÇÇ 
filter
ÇÇ 
.
ÇÇ  
And
ÇÇ  #
(
ÇÇ# $
x
ÇÇ$ %
=>
ÇÇ& (
x
ÇÇ) *
.
ÇÇ* +
Vegan
ÇÇ+ 0
==
ÇÇ1 3
productFilter
ÇÇ4 A
.
ÇÇA B
Vegan
ÇÇB G
)
ÇÇG H
;
ÇÇH I
}
ÉÉ 
if
ÖÖ 
(
ÖÖ 
productFilter
ÖÖ 
.
ÖÖ 

Vegetarian
ÖÖ (
)
ÖÖ( )
{
ÜÜ 
if
áá 
(
áá 
filter
áá 
==
áá 
null
áá "
)
áá" #
{
àà 
filter
ââ 
=
ââ 
PredicateBuilder
ââ -
.
ââ- .
New
ââ. 1
<
ââ1 2
Product
ââ2 9
>
ââ9 :
(
ââ: ;
true
ââ; ?
)
ââ? @
;
ââ@ A
}
ää 
filter
åå 
=
åå 
filter
åå 
.
åå  
And
åå  #
(
åå# $
x
åå$ %
=>
åå& (
x
åå) *
.
åå* +

Vegetarian
åå+ 5
==
åå6 8
productFilter
åå9 F
.
ååF G

Vegetarian
ååG Q
)
ååQ R
;
ååR S
}
çç 
if
èè 
(
èè 
!
èè 
string
èè 
.
èè  
IsNullOrWhiteSpace
èè *
(
èè* +
productFilter
èè+ 8
.
èè8 9!
NameCategoryProduct
èè9 L
)
èèL M
)
èèM N
{
êê 
if
ëë 
(
ëë 
filter
ëë 
==
ëë 
null
ëë "
)
ëë" #
{
íí 
filter
ìì 
=
ìì 
PredicateBuilder
ìì -
.
ìì- .
New
ìì. 1
<
ìì1 2
Product
ìì2 9
>
ìì9 :
(
ìì: ;
true
ìì; ?
)
ìì? @
;
ìì@ A
}
îî 
filter
ññ 
=
ññ 
filter
ññ 
.
ññ  
And
ññ  #
(
ññ# $
x
ññ$ %
=>
ññ& (
x
ññ) *
.
ññ* +
CategoryProduct
ññ+ :
.
ññ: ;
Name
ññ; ?
==
ññ@ B
productFilter
ññC P
.
ññP Q!
NameCategoryProduct
ññQ d
)
ññd e
;
ññe f
}
óó 
if
ôô 
(
ôô 
productFilter
ôô 
.
ôô 
	CreatedAt
ôô '
.
ôô' (
Year
ôô( ,
>
ôô- .
$num
ôô/ 0
)
ôô0 1
{
öö 
if
õõ 
(
õõ 
filter
õõ 
==
õõ 
null
õõ "
)
õõ" #
{
úú 
filter
ùù 
=
ùù 
PredicateBuilder
ùù -
.
ùù- .
New
ùù. 1
<
ùù1 2
Product
ùù2 9
>
ùù9 :
(
ùù: ;
true
ùù; ?
)
ùù? @
;
ùù@ A
}
ûû 
filter
†† 
=
†† 
filter
†† 
.
††  
And
††  #
(
††# $
x
††$ %
=>
††& (
x
††) *
.
††* +
Id
††+ -
==
††. 0
productFilter
††1 >
.
††> ?
Id
††? A
)
††A B
;
††B C
}
°° 
if
££ 
(
££ 
!
££ 
string
££ 
.
££  
IsNullOrWhiteSpace
££ *
(
££* +
productFilter
££+ 8
.
££8 9
Order
££9 >
)
££> ?
)
££? @
{
§§ 
switch
•• 
(
•• 
productFilter
•• %
.
••% &
Order
••& +
)
••+ ,
{
¶¶ 
case
ßß 
$str
ßß 
:
ßß 
ordeBy
®® 
=
®®  
x
®®! "
=>
®®# %
x
®®& '
.
®®' (
OrderBy
®®( /
(
®®/ 0
n
®®0 1
=>
®®2 4
n
®®5 6
.
®®6 7
Id
®®7 9
)
®®9 :
;
®®: ;
break
©© 
;
©© 
case
™™ 
$str
™™ 
:
™™  
ordeBy
´´ 
=
´´  
x
´´! "
=>
´´# %
x
´´& '
.
´´' (
OrderBy
´´( /
(
´´/ 0
n
´´0 1
=>
´´2 4
n
´´5 6
.
´´6 7
Name
´´7 ;
)
´´; <
;
´´< =
break
¨¨ 
;
¨¨ 
case
≠≠ 
$str
≠≠ &
:
≠≠& '
ordeBy
ÆÆ 
=
ÆÆ  
x
ÆÆ! "
=>
ÆÆ# %
x
ÆÆ& '
.
ÆÆ' (
OrderBy
ÆÆ( /
(
ÆÆ/ 0
n
ÆÆ0 1
=>
ÆÆ2 4
n
ÆÆ5 6
.
ÆÆ6 7
Description
ÆÆ7 B
)
ÆÆB C
;
ÆÆC D
break
ØØ 
;
ØØ 
case
∞∞ 
$str
∞∞  
:
∞∞  !
ordeBy
±± 
=
±±  
x
±±! "
=>
±±# %
x
±±& '
.
±±' (
OrderBy
±±( /
(
±±/ 0
n
±±0 1
=>
±±2 4
n
±±5 6
.
±±6 7
Price
±±7 <
)
±±< =
;
±±= >
break
≤≤ 
;
≤≤ 
case
≥≥ 
$str
≥≥ $
:
≥≥$ %
ordeBy
¥¥ 
=
¥¥  
x
¥¥! "
=>
¥¥# %
x
¥¥& '
.
¥¥' (
OrderBy
¥¥( /
(
¥¥/ 0
n
¥¥0 1
=>
¥¥2 4
n
¥¥5 6
.
¥¥6 7
	CreatedAt
¥¥7 @
)
¥¥@ A
;
¥¥A B
break
µµ 
;
µµ 
}
∂∂ 
}
∑∑ 
return
ππ 
await
ππ  
_productRepository
ππ +
.
∫∫ 
Search
∫∫ 
(
∫∫ 
filter
ªª 
,
ªª 
ordeBy
ºº 
,
ºº 
productFilter
ΩΩ !
.
ΩΩ! "
PageSize
ΩΩ" *
,
ΩΩ* +
productFilter
ææ !
.
ææ! "
	PageIndex
ææ" +
)
ææ+ ,
;
ææ, -
}
øø 	
public
¡¡ 
async
¡¡ 
Task
¡¡ 
<
¡¡ 
Product
¡¡ !
>
¡¡! "
GetById
¡¡# *
(
¡¡* +
Guid
¡¡+ /
id
¡¡0 2
)
¡¡2 3
{
¬¬ 	
return
√√ 
await
√√  
_productRepository
√√ +
.
ƒƒ 
GetById
ƒƒ 
(
ƒƒ 
id
ƒƒ 
)
ƒƒ 
;
ƒƒ 
}
≈≈ 	
public
«« 
async
«« 
Task
«« 
<
«« 
Product
«« !
>
««! "
Update
««# )
(
««) *
Product
««* 1
product
««2 9
)
««9 :
{
»» 	
if
…… 
(
…… 
!
…… 
Validate
…… 
(
…… 
new
…… 
ProductValidation
…… /
(
……/ 0
)
……0 1
,
……1 2
product
……3 :
)
……: ;
)
……; <
return
……= C
null
……D H
;
……H I
var
ÀÀ 
	productDB
ÀÀ 
=
ÀÀ 
await
ÀÀ ! 
_productRepository
ÀÀ" 4
.
ÃÃ 
GetById
ÃÃ 
(
ÃÃ 
product
ÃÃ  
.
ÃÃ  !
Id
ÃÃ! #
)
ÃÃ# $
;
ÃÃ$ %
if
ŒŒ 
(
ŒŒ 
	productDB
ŒŒ 
==
ŒŒ 
null
ŒŒ !
)
ŒŒ! "
{
œœ 
NotifyError
–– 
(
–– 
$str
–– '
)
––' (
;
––( )
return
—— 
await
—— 
Task
—— !
.
——! "

FromResult
——" ,
<
——, -
Product
——- 4
>
——4 5
(
——5 6
null
——6 :
)
——: ;
;
——; <
}
““ 
if
‘‘ 
(
‘‘ 
product
‘‘ 
.
‘‘ 
CategoryProduct
‘‘ '
!=
‘‘( *
null
‘‘+ /
)
‘‘/ 0
{
’’ 
var
÷÷ 
categoryProduct
÷÷ #
=
÷÷$ %
await
÷÷& +(
_categoryProductRepository
÷÷, F
.
◊◊ 
GetById
◊◊ 
(
◊◊ 
product
◊◊ $
.
◊◊$ %
IdCategoryProduct
◊◊% 6
)
◊◊6 7
;
◊◊7 8
if
ŸŸ 
(
ŸŸ 
categoryProduct
ŸŸ #
==
ŸŸ$ &
null
ŸŸ' +
)
ŸŸ+ ,
{
⁄⁄ 
NotifyError
€€ 
(
€€  
$str
€€  <
)
€€< =
;
€€= >
return
‹‹ 
await
‹‹  
Task
‹‹! %
.
‹‹% &

FromResult
‹‹& 0
<
‹‹0 1
Product
‹‹1 8
>
‹‹8 9
(
‹‹9 :
null
‹‹: >
)
‹‹> ?
;
‹‹? @
}
›› 
}
ﬂﬂ 
if
·· 
(
·· 
	productDB
·· 
.
·· 
Name
·· 
!=
·· !
product
··" )
.
··) *
Name
··* .
)
··. /
{
‚‚ 
	productDB
„„ 
.
„„ 
Name
„„ 
=
„„  
product
„„! (
.
„„( )
Name
„„) -
;
„„- .
}
‰‰ 
if
ÊÊ 
(
ÊÊ 
	productDB
ÊÊ 
.
ÊÊ 
Description
ÊÊ %
!=
ÊÊ& (
product
ÊÊ) 0
.
ÊÊ0 1
Description
ÊÊ1 <
)
ÊÊ< =
{
ÁÁ 
	productDB
ËË 
.
ËË 
Description
ËË %
=
ËË& '
product
ËË( /
.
ËË/ 0
Description
ËË0 ;
;
ËË; <
}
ÈÈ 
if
ÎÎ 
(
ÎÎ 
	productDB
ÎÎ 
.
ÎÎ 
Price
ÎÎ 
!=
ÎÎ  "
product
ÎÎ# *
.
ÎÎ* +
Price
ÎÎ+ 0
)
ÎÎ0 1
{
ÏÏ 
	productDB
ÌÌ 
.
ÌÌ 
Price
ÌÌ 
=
ÌÌ  !
product
ÌÌ" )
.
ÌÌ) *
Price
ÌÌ* /
;
ÌÌ/ 0
}
ÓÓ 
if
 
(
 
	productDB
 
.
 
Kosher
  
!=
! #
product
$ +
.
+ ,
Kosher
, 2
)
2 3
{
ÒÒ 
	productDB
ÚÚ 
.
ÚÚ 
Kosher
ÚÚ  
=
ÚÚ! "
product
ÚÚ# *
.
ÚÚ* +
Kosher
ÚÚ+ 1
;
ÚÚ1 2
}
ÛÛ 
if
ıı 
(
ıı 
	productDB
ıı 
.
ıı 
Vegan
ıı 
!=
ıı  "
product
ıı# *
.
ıı* +
Vegan
ıı+ 0
)
ıı0 1
{
ˆˆ 
	productDB
˜˜ 
.
˜˜ 
Vegan
˜˜ 
=
˜˜  !
product
˜˜" )
.
˜˜) *
Vegan
˜˜* /
;
˜˜/ 0
}
¯¯ 
if
˙˙ 
(
˙˙ 
	productDB
˙˙ 
.
˙˙ 

Vegetarian
˙˙ $
!=
˙˙% '
product
˙˙( /
.
˙˙/ 0

Vegetarian
˙˙0 :
)
˙˙: ;
{
˚˚ 
	productDB
¸¸ 
.
¸¸ 

Vegetarian
¸¸ $
=
¸¸% &
product
¸¸' .
.
¸¸. /

Vegetarian
¸¸/ 9
;
¸¸9 :
}
˝˝ 
if
ˇˇ 
(
ˇˇ 
	productDB
ˇˇ 
.
ˇˇ 
Image
ˇˇ 
!=
ˇˇ  "
product
ˇˇ# *
.
ˇˇ* +
Image
ˇˇ+ 0
)
ˇˇ0 1
{
ÄÄ 
	productDB
ÅÅ 
.
ÅÅ 
Image
ÅÅ 
=
ÅÅ  !
product
ÅÅ" )
.
ÅÅ) *
Image
ÅÅ* /
;
ÅÅ/ 0
}
ÇÇ  
_productRepository
ÑÑ 
.
ÖÖ 
Update
ÖÖ 
(
ÖÖ 
	productDB
ÖÖ !
)
ÖÖ! "
;
ÖÖ" #
if
áá 
(
áá 
await
áá  
_productRepository
áá (
.
áá( )
Commit
áá) /
(
áá/ 0
)
áá0 1
)
áá1 2
{
àà 
return
ââ 
await
ââ 
Task
ââ !
.
ââ! "

FromResult
ââ" ,
(
ââ, -
	productDB
ââ- 6
)
ââ6 7
;
ââ7 8
}
ää 
NotifyError
åå 
(
åå 
$str
åå /
)
åå/ 0
;
åå0 1
return
çç 
await
çç 
Task
çç 
.
çç 

FromResult
çç (
<
çç( )
Product
çç) 0
>
çç0 1
(
çç1 2
null
çç2 6
)
çç6 7
;
çç7 8
}
éé 	
public
êê 
async
êê 
Task
êê 
<
êê 
Product
êê !
>
êê! "
Delete
êê# )
(
êê) *
Guid
êê* .
id
êê/ 1
)
êê1 2
{
ëë 	
var
íí 
product
íí 
=
íí 
await
íí  
_productRepository
íí  2
.
ìì 
GetById
ìì 
(
ìì 
id
ìì 
)
ìì 
;
ìì 
if
ïï 
(
ïï 
product
ïï 
==
ïï 
null
ïï 
)
ïï  
{
ññ 
NotifyError
óó 
(
óó 
$str
óó '
)
óó' (
;
óó( )
return
òò 
await
òò 
Task
òò !
.
òò! "

FromResult
òò" ,
<
òò, -
Product
òò- 4
>
òò4 5
(
òò5 6
null
òò6 :
)
òò: ;
;
òò; <
}
ôô  
_productRepository
õõ 
.
úú 
Remove
úú 
(
úú 
id
úú 
)
úú 
;
úú 
if
ûû 
(
ûû 
await
ûû  
_productRepository
ûû (
.
ûû( )
Commit
ûû) /
(
ûû/ 0
)
ûû0 1
)
ûû1 2
{
üü 
return
†† 
await
†† 
Task
†† !
.
††! "

FromResult
††" ,
(
††, -
product
††- 4
)
††4 5
;
††5 6
}
°° 
NotifyError
££ 
(
££ 
$str
££ /
)
££/ 0
;
££0 1
return
§§ 
await
§§ 
Task
§§ 
.
§§ 

FromResult
§§ (
<
§§( )
Product
§§) 0
>
§§0 1
(
§§1 2
null
§§2 6
)
§§6 7
;
§§7 8
}
•• 	
public
ßß 
async
ßß 
Task
ßß 
<
ßß 
List
ßß 
<
ßß 
Product
ßß &
>
ßß& '
>
ßß' (
GetByRestaurant
ßß) 8
(
ßß8 9
Guid
ßß9 =
id
ßß> @
)
ßß@ A
{
®® 	
var
©© 

restaurant
©© 
=
©© 
await
©© "#
_restaurantRepository
©©# 8
.
™™ 
GetById
™™ 
(
™™ 
id
™™ 
)
™™ 
;
™™ 
if
¨¨ 
(
¨¨ 

restaurant
¨¨ 
==
¨¨ 
null
¨¨ !
)
¨¨! "
{
≠≠ 
NotifyError
ÆÆ 
(
ÆÆ 
$str
ÆÆ 3
)
ÆÆ3 4
;
ÆÆ4 5
return
ØØ 
await
ØØ 
Task
ØØ !
.
ØØ! "

FromResult
ØØ" ,
<
ØØ, -
List
ØØ- 1
<
ØØ1 2
Product
ØØ2 9
>
ØØ9 :
>
ØØ: ;
(
ØØ; <
null
ØØ< @
)
ØØ@ A
;
ØØA B
}
∞∞ 
return
≤≤ 
await
≤≤  
_productRepository
≤≤ +
.
≥≥ 
GetByRestaurant
≥≥ !
(
≥≥! "
id
≥≥" $
)
≥≥$ %
;
≥≥% &
}
¥¥ 	
public
∂∂ 
async
∂∂ 
Task
∂∂ 
<
∂∂ 
Product
∂∂ !
>
∂∂! "(
GetByRestaurantByIdProduct
∂∂# =
(
∂∂= >
Guid
∂∂> B
idRestaurant
∂∂C O
,
∂∂O P
Guid
∂∂Q U
	idProduct
∂∂V _
)
∂∂_ `
{
∑∑ 	
var
∏∏ 

restaurant
∏∏ 
=
∏∏ 
await
∏∏ "#
_restaurantRepository
∏∏# 8
.
ππ 
GetById
ππ 
(
ππ 
idRestaurant
ππ %
)
ππ% &
;
ππ& '
if
ªª 
(
ªª 

restaurant
ªª 
==
ªª 
null
ªª "
)
ªª" #
{
ºº 
NotifyError
ΩΩ 
(
ΩΩ 
$str
ΩΩ 3
)
ΩΩ3 4
;
ΩΩ4 5
return
ææ 
await
ææ 
Task
ææ !
.
ææ! "

FromResult
ææ" ,
<
ææ, -
Product
ææ- 4
>
ææ4 5
(
ææ5 6
null
ææ6 :
)
ææ: ;
;
ææ; <
}
øø 
return
¡¡ 
await
¡¡  
_productRepository
¡¡ +
.
¬¬ (
GetByRestaurantByIdProduct
¬¬ ,
(
¬¬, -
idRestaurant
¬¬- 9
,
¬¬9 :
	idProduct
¬¬; D
)
¬¬D E
;
¬¬E F
}
√√ 	
}
ƒƒ 
}≈≈ ¥¿
QD:\TI\git\v2\IHunger_API\IHunger\3 - Service\IHunger.Service\RestaurantService.cs
	namespace 	
IHunger
 
. 
Service 
{ 
public 

class 
RestaurantService "
:# $
BaseService% 0
,0 1
IRestaurantService2 D
{ 
private 
readonly !
IRestaurantRepository .!
_restaurantRepository/ D
;D E
private 
readonly )
ICategoryRestaurantRepository 6)
_categoryRestaurantRepository7 T
;T U
public 
RestaurantService  
(  !!
IRestaurantRepository ! 
restaurantRepository" 6
,6 7)
ICategoryRestaurantRepository )(
categoryRestaurantRepository* F
,F G
	INotifier 
notifier 
) 
:  !
base" &
(& '
notifier' /
)/ 0
{ 	!
_restaurantRepository !
=" # 
restaurantRepository$ 8
;8 9)
_categoryRestaurantRepository )
=* +(
categoryRestaurantRepository, H
;H I
} 	
public   
async   
Task   
<   

Restaurant   $
>  $ %
Create  & ,
(  , -

Restaurant  - 7

restaurant  8 B
)  B C
{!! 	
if"" 
("" 
!"" 
Validate"" 
("" 
new""  
RestaurantValidation"" 2
(""2 3
)""3 4
,""4 5

restaurant""6 @
)""@ A
)""A B
return""C I
null""J N
;""N O
if## 
(## 
!## 
Validate## 
(## 
new## '
AddressRestaurantValidation## 9
(##9 :
)##: ;
,##; <

restaurant##= G
.##G H
AddressRestaurant##H Y
)##Y Z
)##Z [
return##\ b
null##c g
;##g h
var%% 
restaurantBD%% 
=%% 
await%% $!
_restaurantRepository%%% :
.&& 
Search&& 
(&& 
x&& 
=>&& 
x&& 
.&& 
Name&& #
==&&$ &

restaurant&&' 1
.&&1 2
Name&&2 6
)&&6 7
;&&7 8
if(( 
((( 
restaurantBD(( 
!=(( 
null((  $
&&((% '
restaurantBD((( 4
.((4 5
Any((5 8
(((8 9
)((9 :
)((: ;
{)) 
NotifyError** 
(** 
$str** E
)**E F
;**F G
return++ 
await++ 
Task++ !
.++! "

FromResult++" ,
<++, -

Restaurant++- 7
>++7 8
(++8 9
null++9 =
)++= >
;++> ?
},, 
var.. 
categoryRestaurant.. "
=..# $
await..% *)
_categoryRestaurantRepository..+ H
.// 
GetById// 
(// 

restaurant// #
.//# $ 
IdCategoryRestaurant//$ 8
)//8 9
;//9 :
if11 
(11 
categoryRestaurant11 "
==11# %
null11& *
)11* +
{22 
NotifyError33 
(33 
$str33 ;
)33; <
;33< =
return44 
await44 
Task44 !
.44! "

FromResult44" ,
<44, -

Restaurant44- 7
>447 8
(448 9
null449 =
)44= >
;44> ?
}55 
await77 !
_restaurantRepository77 '
.88 
Add88 
(88 

restaurant88 
)88  
;88  !
if:: 
(:: 
await:: !
_restaurantRepository:: +
.::+ ,
Commit::, 2
(::2 3
)::3 4
)::4 5
{;; 
return<< 
await<< 
Task<< !
.<<! "

FromResult<<" ,
(<<, -

restaurant<<- 7
)<<7 8
;<<8 9
}== 
NotifyError?? 
(?? 
$str?? 0
)??0 1
;??1 2
return@@ 
await@@ 
Task@@ 
.@@ 

FromResult@@ (
<@@( )

Restaurant@@) 3
>@@3 4
(@@4 5
null@@5 9
)@@9 :
;@@: ;
}AA 	
publicCC 
asyncCC 
TaskCC 
<CC 
ListCC 
<CC 

RestaurantCC )
>CC) *
>CC* +
GetAllWithFilterCC, <
(CC< =
RestaurantFilterCC= M
restaurantFilterCCN ^
)CC^ _
{DD 	

ExpressionEE 
<EE 
FuncEE 
<EE 

RestaurantEE &
,EE& '
boolEE( ,
>EE, -
>EE- .
filterEE/ 5
=EE6 7
nullEE8 <
;EE< =
FuncFF 
<FF 

IQueryableFF 
<FF 

RestaurantFF &
>FF& '
,FF' (
IOrderedQueryableFF) :
<FF: ;

RestaurantFF; E
>FFE F
>FFF G
ordeByFFH N
=FFO P
nullFFQ U
;FFU V
ifHH 
(HH 
!HH 
stringHH 
.HH 
IsNullOrWhiteSpaceHH *
(HH* +
restaurantFilterHH+ ;
.HH; <
NameHH< @
)HH@ A
)HHA B
{II 
ifJJ 
(JJ 
filterJJ 
==JJ 
nullJJ "
)JJ" #
{KK 
filterLL 
=LL 
PredicateBuilderLL -
.LL- .
NewLL. 1
<LL1 2

RestaurantLL2 <
>LL< =
(LL= >
trueLL> B
)LLB C
;LLC D
}MM 
filterOO 
=OO 
filterOO 
.OO  
AndOO  #
(OO# $
xOO$ %
=>OO& (
xOO) *
.OO* +
NameOO+ /
==OO0 2
restaurantFilterOO3 C
.OOC D
NameOOD H
)OOH I
;OOI J
}PP 
ifRR 
(RR 
!RR 
stringRR 
.RR 
IsNullOrWhiteSpaceRR *
(RR* +
restaurantFilterRR+ ;
.RR; <
DescriptionRR< G
)RRG H
)RRH I
{SS 
ifTT 
(TT 
filterTT 
==TT 
nullTT "
)TT" #
{UU 
filterVV 
=VV 
PredicateBuilderVV -
.VV- .
NewVV. 1
<VV1 2

RestaurantVV2 <
>VV< =
(VV= >
trueVV> B
)VVB C
;VVC D
}WW 
filterYY 
=YY 
filterYY 
.YY  
AndYY  #
(YY# $
xYY$ %
=>YY& (
xYY) *
.YY* +
DescriptionYY+ 6
==YY7 9
restaurantFilterYY: J
.YYJ K
DescriptionYYK V
)YYV W
;YYW X
}ZZ 
if\\ 
(\\ 
!\\ 
string\\ 
.\\ 
IsNullOrWhiteSpace\\ *
(\\* +
restaurantFilter\\+ ;
.\\; <
CategoryName\\< H
)\\H I
)\\I J
{]] 
if^^ 
(^^ 
filter^^ 
==^^ 
null^^ "
)^^" #
{__ 
filter`` 
=`` 
PredicateBuilder`` -
.``- .
New``. 1
<``1 2

Restaurant``2 <
>``< =
(``= >
true``> B
)``B C
;``C D
}aa 
filtercc 
=cc 
filtercc 
.cc  
Andcc  #
(cc# $
xcc$ %
=>cc& (
xcc) *
.cc* +
CategoryRestaurantcc+ =
.cc= >
Namecc> B
==ccC E
restaurantFilterccF V
.ccV W
CategoryNameccW c
)ccc d
;ccd e
}dd 
ifff 
(ff 
!ff 
stringff 
.ff 
IsNullOrWhiteSpaceff *
(ff* +
restaurantFilterff+ ;
.ff; <
Orderff< A
)ffA B
)ffB C
{gg 
switchhh 
(hh 
restaurantFilterhh (
.hh( )
Orderhh) .
)hh. /
{ii 
casejj 
$strjj 
:jj 
ordeBykk 
=kk  
xkk! "
=>kk# %
xkk& '
.kk' (
OrderBykk( /
(kk/ 0
nkk0 1
=>kk2 4
nkk5 6
.kk6 7
Idkk7 9
)kk9 :
;kk: ;
breakll 
;ll 
casemm 
$strmm 
:mm  
ordeBynn 
=nn  
xnn! "
=>nn# %
xnn& '
.nn' (
OrderBynn( /
(nn/ 0
nnn0 1
=>nn2 4
nnn5 6
.nn6 7
Namenn7 ;
)nn; <
;nn< =
breakoo 
;oo 
casepp 
$strpp &
:pp& '
ordeByqq 
=qq  
xqq! "
=>qq# %
xqq& '
.qq' (
OrderByqq( /
(qq/ 0
nqq0 1
=>qq2 4
nqq5 6
.qq6 7
Descriptionqq7 B
)qqB C
;qqC D
breakrr 
;rr 
casess 
$strss $
:ss$ %
ordeBytt 
=tt  
xtt! "
=>tt# %
xtt& '
.tt' (
OrderBytt( /
(tt/ 0
ntt0 1
=>tt2 4
ntt5 6
.tt6 7
	CreatedAttt7 @
)tt@ A
;ttA B
breakuu 
;uu 
}vv 
}ww 
ifyy 
(yy 
restaurantFilteryy  
.yy  !
Idyy! #
!=yy$ &
Guidyy' +
.yy+ ,
Emptyyy, 1
)yy1 2
{zz 
if{{ 
({{ 
filter{{ 
=={{ 
null{{ "
){{" #
{|| 
filter}} 
=}} 
PredicateBuilder}} -
.}}- .
New}}. 1
<}}1 2

Restaurant}}2 <
>}}< =
(}}= >
true}}> B
)}}B C
;}}C D
}~~ 
filter
ÄÄ 
=
ÄÄ 
filter
ÄÄ 
.
ÄÄ  
And
ÄÄ  #
(
ÄÄ# $
x
ÄÄ$ %
=>
ÄÄ& (
x
ÄÄ) *
.
ÄÄ* +
Id
ÄÄ+ -
==
ÄÄ. 0
restaurantFilter
ÄÄ1 A
.
ÄÄA B
Id
ÄÄB D
)
ÄÄD E
;
ÄÄE F
}
ÅÅ 
if
ÉÉ 
(
ÉÉ 
restaurantFilter
ÉÉ  
.
ÉÉ  !

CategoryId
ÉÉ! +
!=
ÉÉ, .
Guid
ÉÉ/ 3
.
ÉÉ3 4
Empty
ÉÉ4 9
)
ÉÉ9 :
{
ÑÑ 
if
ÖÖ 
(
ÖÖ 
filter
ÖÖ 
==
ÖÖ 
null
ÖÖ "
)
ÖÖ" #
{
ÜÜ 
filter
áá 
=
áá 
PredicateBuilder
áá -
.
áá- .
New
áá. 1
<
áá1 2

Restaurant
áá2 <
>
áá< =
(
áá= >
true
áá> B
)
ááB C
;
ááC D
}
àà 
filter
ää 
=
ää 
filter
ää 
.
ää  
And
ää  #
(
ää# $
x
ää$ %
=>
ää& (
x
ää) *
.
ää* + 
CategoryRestaurant
ää+ =
.
ää= >
Id
ää> @
==
ääA C
restaurantFilter
ääD T
.
ääT U

CategoryId
ääU _
)
ää_ `
;
ää` a
}
ãã 
if
çç 
(
çç 
restaurantFilter
çç  
.
çç  !
	CreatedAt
çç! *
.
çç* +
Year
çç+ /
>
çç0 1
$num
çç2 3
)
çç3 4
{
éé 
if
èè 
(
èè 
filter
èè 
==
èè 
null
èè "
)
èè" #
{
êê 
filter
ëë 
=
ëë 
PredicateBuilder
ëë -
.
ëë- .
New
ëë. 1
<
ëë1 2

Restaurant
ëë2 <
>
ëë< =
(
ëë= >
true
ëë> B
)
ëëB C
;
ëëC D
}
íí 
filter
îî 
=
îî 
filter
îî 
.
îî  
And
îî  #
(
îî# $
x
îî$ %
=>
îî& (
x
îî) *
.
îî* +
Id
îî+ -
==
îî. 0
restaurantFilter
îî1 A
.
îîA B
Id
îîB D
)
îîD E
;
îîE F
}
ïï 
return
óó 
await
óó #
_restaurantRepository
óó .
.
òò 
Search
òò 
(
òò 
filter
ôô 
,
ôô 
ordeBy
öö 
,
öö 
restaurantFilter
õõ $
.
õõ$ %
PageSize
õõ% -
,
õõ- .
restaurantFilter
úú $
.
úú$ %
	PageIndex
úú% .
)
úú. /
;
úú/ 0
}
ùù 	
public
üü 
async
üü 
Task
üü 
<
üü 

Restaurant
üü $
>
üü$ %
GetById
üü& -
(
üü- .
Guid
üü. 2
id
üü3 5
)
üü5 6
{
†† 	
return
°° 
await
°° #
_restaurantRepository
°° .
.
¢¢ 
GetById
¢¢ 
(
¢¢ 
id
¢¢ 
)
¢¢ 
;
¢¢ 
}
££ 	
public
•• 
async
•• 
Task
•• 
<
•• 

Restaurant
•• $
>
••$ %
Update
••& ,
(
••, -

Restaurant
••- 7

restaurant
••8 B
)
••B C
{
¶¶ 	
if
ßß 
(
ßß 
!
ßß 
Validate
ßß 
(
ßß 
new
ßß "
RestaurantValidation
ßß 2
(
ßß2 3
)
ßß3 4
,
ßß4 5

restaurant
ßß6 @
)
ßß@ A
)
ßßA B
return
ßßC I
null
ßßJ N
;
ßßN O
var
©© 
restaurantDB
©© 
=
©© 
await
©© $#
_restaurantRepository
©©% :
.
™™ 
GetById
™™ 
(
™™ 

restaurant
™™ #
.
™™# $
Id
™™$ &
)
™™& '
;
™™' (
if
¨¨ 
(
¨¨ 
restaurantDB
¨¨ 
==
¨¨ 
null
¨¨  $
)
¨¨$ %
{
≠≠ 
NotifyError
ÆÆ 
(
ÆÆ 
$str
ÆÆ '
)
ÆÆ' (
;
ÆÆ( )
return
ØØ 
await
ØØ 
Task
ØØ !
.
ØØ! "

FromResult
ØØ" ,
<
ØØ, -

Restaurant
ØØ- 7
>
ØØ7 8
(
ØØ8 9
null
ØØ9 =
)
ØØ= >
;
ØØ> ?
}
∞∞ 
if
≤≤ 
(
≤≤ 

restaurant
≤≤ 
.
≤≤  
CategoryRestaurant
≤≤ -
!=
≤≤. 0
null
≤≤1 5
)
≤≤5 6
{
≥≥ 
if
¥¥ 
(
¥¥ 
!
¥¥ 
Validate
¥¥ 
(
¥¥ 
new
¥¥ !)
AddressRestaurantValidation
¥¥" =
(
¥¥= >
)
¥¥> ?
,
¥¥? @

restaurant
¥¥A K
.
¥¥K L
AddressRestaurant
¥¥L ]
)
¥¥] ^
)
¥¥^ _
return
¥¥` f
null
¥¥g k
;
¥¥k l
var
∂∂  
categoryRestaurant
∂∂ &
=
∂∂' (
await
∂∂) .+
_categoryRestaurantRepository
∂∂/ L
.
∑∑ 
GetById
∑∑ 
(
∑∑ 

restaurant
∑∑ '
.
∑∑' ("
IdCategoryRestaurant
∑∑( <
)
∑∑< =
;
∑∑= >
if
ππ 
(
ππ  
categoryRestaurant
ππ &
==
ππ' )
null
ππ* .
)
ππ. /
{
∫∫ 
NotifyError
ªª 
(
ªª  
$str
ªª  ?
)
ªª? @
;
ªª@ A
return
ºº 
await
ºº  
Task
ºº! %
.
ºº% &

FromResult
ºº& 0
<
ºº0 1

Restaurant
ºº1 ;
>
ºº; <
(
ºº< =
null
ºº= A
)
ººA B
;
ººB C
}
ΩΩ 
}
øø 
if
¡¡ 
(
¡¡ 

restaurant
¡¡ 
.
¡¡ 
AddressRestaurant
¡¡ ,
!=
¡¡- /
null
¡¡0 4
)
¡¡4 5
{
¬¬ 
if
√√ 
(
√√ 
restaurantDB
√√  
.
√√  !
AddressRestaurant
√√! 2
.
√√2 3
Street
√√3 9
!=
√√: <

restaurant
√√= G
.
√√G H
AddressRestaurant
√√H Y
.
√√Y Z
Street
√√Z `
)
√√` a
{
ƒƒ 
restaurantDB
≈≈  
.
≈≈  !
AddressRestaurant
≈≈! 2
.
≈≈2 3
Street
≈≈3 9
=
≈≈: ;

restaurant
≈≈< F
.
≈≈F G
AddressRestaurant
≈≈G X
.
≈≈X Y
Street
≈≈Y _
;
≈≈_ `
}
∆∆ 
if
»» 
(
»» 
restaurantDB
»»  
.
»»  !
AddressRestaurant
»»! 2
.
»»2 3
District
»»3 ;
!=
»»< >

restaurant
»»? I
.
»»I J
AddressRestaurant
»»J [
.
»»[ \
District
»»\ d
)
»»d e
{
…… 
restaurantDB
    
.
    !
AddressRestaurant
  ! 2
.
  2 3
District
  3 ;
=
  < =

restaurant
  > H
.
  H I
AddressRestaurant
  I Z
.
  Z [
District
  [ c
;
  c d
}
ÀÀ 
if
ÕÕ 
(
ÕÕ 
restaurantDB
ÕÕ  
.
ÕÕ  !
AddressRestaurant
ÕÕ! 2
.
ÕÕ2 3
City
ÕÕ3 7
!=
ÕÕ8 :

restaurant
ÕÕ; E
.
ÕÕE F
AddressRestaurant
ÕÕF W
.
ÕÕW X
City
ÕÕX \
)
ÕÕ\ ]
{
ŒŒ 
restaurantDB
œœ  
.
œœ  !
AddressRestaurant
œœ! 2
.
œœ2 3
City
œœ3 7
=
œœ8 9

restaurant
œœ: D
.
œœD E
AddressRestaurant
œœE V
.
œœV W
City
œœW [
;
œœ[ \
}
–– 
if
““ 
(
““ 
restaurantDB
““  
.
““  !
AddressRestaurant
““! 2
.
““2 3
County
““3 9
!=
““: <

restaurant
““= G
.
““G H
AddressRestaurant
““H Y
.
““Y Z
County
““Z `
)
““` a
{
”” 
restaurantDB
‘‘  
.
‘‘  !
AddressRestaurant
‘‘! 2
.
‘‘2 3
County
‘‘3 9
=
‘‘: ;

restaurant
‘‘< F
.
‘‘F G
AddressRestaurant
‘‘G X
.
‘‘X Y
County
‘‘Y _
;
‘‘_ `
}
’’ 
if
◊◊ 
(
◊◊ 
restaurantDB
◊◊  
.
◊◊  !
AddressRestaurant
◊◊! 2
.
◊◊2 3
ZipCode
◊◊3 :
!=
◊◊; =

restaurant
◊◊> H
.
◊◊H I
AddressRestaurant
◊◊I Z
.
◊◊Z [
ZipCode
◊◊[ b
)
◊◊b c
{
ÿÿ 
restaurantDB
ŸŸ  
.
ŸŸ  !
AddressRestaurant
ŸŸ! 2
.
ŸŸ2 3
ZipCode
ŸŸ3 :
=
ŸŸ; <

restaurant
ŸŸ= G
.
ŸŸG H
AddressRestaurant
ŸŸH Y
.
ŸŸY Z
ZipCode
ŸŸZ a
;
ŸŸa b
}
⁄⁄ 
if
‹‹ 
(
‹‹ 
restaurantDB
‹‹  
.
‹‹  !
AddressRestaurant
‹‹! 2
.
‹‹2 3
Latitude
‹‹3 ;
!=
‹‹< >

restaurant
‹‹? I
.
‹‹I J
AddressRestaurant
‹‹J [
.
‹‹[ \
Latitude
‹‹\ d
)
‹‹d e
{
›› 
restaurantDB
ﬁﬁ  
.
ﬁﬁ  !
AddressRestaurant
ﬁﬁ! 2
.
ﬁﬁ2 3
Latitude
ﬁﬁ3 ;
=
ﬁﬁ< =

restaurant
ﬁﬁ> H
.
ﬁﬁH I
AddressRestaurant
ﬁﬁI Z
.
ﬁﬁZ [
Latitude
ﬁﬁ[ c
;
ﬁﬁc d
}
ﬂﬂ 
if
·· 
(
·· 
restaurantDB
··  
.
··  !
AddressRestaurant
··! 2
.
··2 3
	Longitude
··3 <
!=
··= ?

restaurant
··@ J
.
··J K
AddressRestaurant
··K \
.
··\ ]
	Longitude
··] f
)
··f g
{
‚‚ 
restaurantDB
„„  
.
„„  !
AddressRestaurant
„„! 2
.
„„2 3
	Longitude
„„3 <
=
„„= >

restaurant
„„? I
.
„„I J
AddressRestaurant
„„J [
.
„„[ \
	Longitude
„„\ e
;
„„e f
}
‰‰ 
}
ÂÂ 
if
ÁÁ 
(
ÁÁ 
restaurantDB
ÁÁ 
.
ÁÁ 
Name
ÁÁ !
!=
ÁÁ" $

restaurant
ÁÁ% /
.
ÁÁ/ 0
Name
ÁÁ0 4
)
ÁÁ4 5
{
ËË 
restaurantDB
ÈÈ 
.
ÈÈ 
Name
ÈÈ !
=
ÈÈ" #

restaurant
ÈÈ$ .
.
ÈÈ. /
Name
ÈÈ/ 3
;
ÈÈ3 4
}
ÍÍ 
if
ÏÏ 
(
ÏÏ 
restaurantDB
ÏÏ 
.
ÏÏ 
Description
ÏÏ (
!=
ÏÏ) +

restaurant
ÏÏ, 6
.
ÏÏ6 7
Description
ÏÏ7 B
)
ÏÏB C
{
ÌÌ 
restaurantDB
ÓÓ 
.
ÓÓ 
Description
ÓÓ (
=
ÓÓ) *

restaurant
ÓÓ+ 5
.
ÓÓ5 6
Description
ÓÓ6 A
;
ÓÓA B
}
ÔÔ 
if
ÒÒ 
(
ÒÒ 
restaurantDB
ÒÒ 
.
ÒÒ 
Image
ÒÒ "
!=
ÒÒ# %

restaurant
ÒÒ& 0
.
ÒÒ0 1
Image
ÒÒ1 6
)
ÒÒ6 7
{
ÚÚ 
restaurantDB
ÛÛ 
.
ÛÛ 
Image
ÛÛ "
=
ÛÛ# $

restaurant
ÛÛ% /
.
ÛÛ/ 0
Image
ÛÛ0 5
;
ÛÛ5 6
}
ÙÙ #
_restaurantRepository
ˆˆ !
.
˜˜ 
Update
˜˜ 
(
˜˜ 
restaurantDB
˜˜ $
)
˜˜$ %
;
˜˜% &
if
˘˘ 
(
˘˘ 
await
˘˘ #
_restaurantRepository
˘˘ +
.
˘˘+ ,
Commit
˘˘, 2
(
˘˘2 3
)
˘˘3 4
)
˘˘4 5
{
˙˙ 
return
˚˚ 
await
˚˚ 
Task
˚˚ !
.
˚˚! "

FromResult
˚˚" ,
(
˚˚, -
restaurantDB
˚˚- 9
)
˚˚9 :
;
˚˚: ;
}
¸¸ 
NotifyError
˛˛ 
(
˛˛ 
$str
˛˛ /
)
˛˛/ 0
;
˛˛0 1
return
ˇˇ 
await
ˇˇ 
Task
ˇˇ 
.
ˇˇ 

FromResult
ˇˇ (
<
ˇˇ( )

Restaurant
ˇˇ) 3
>
ˇˇ3 4
(
ˇˇ4 5
null
ˇˇ5 9
)
ˇˇ9 :
;
ˇˇ: ;
}
ÄÄ 	
public
ÇÇ 
async
ÇÇ 
Task
ÇÇ 
<
ÇÇ 

Restaurant
ÇÇ $
>
ÇÇ$ %
Delete
ÇÇ& ,
(
ÇÇ, -
Guid
ÇÇ- 1
id
ÇÇ2 4
)
ÇÇ4 5
{
ÉÉ 	
var
ÑÑ 

restaurant
ÑÑ 
=
ÑÑ 
await
ÑÑ "#
_restaurantRepository
ÑÑ# 8
.
ÖÖ 
GetById
ÖÖ 
(
ÖÖ 
id
ÖÖ 
)
ÖÖ 
;
ÖÖ 
if
áá 
(
áá 

restaurant
áá 
==
áá 
null
áá "
)
áá" #
{
àà 
NotifyError
ââ 
(
ââ 
$str
ââ '
)
ââ' (
;
ââ( )
return
ää 
await
ää 
Task
ää !
.
ää! "

FromResult
ää" ,
<
ää, -

Restaurant
ää- 7
>
ää7 8
(
ää8 9
null
ää9 =
)
ää= >
;
ää> ?
}
ãã #
_restaurantRepository
çç !
.
éé 
Remove
éé 
(
éé 
id
éé 
)
éé 
;
éé 
if
êê 
(
êê 
await
êê #
_restaurantRepository
êê +
.
êê+ ,
Commit
êê, 2
(
êê2 3
)
êê3 4
)
êê4 5
{
ëë 
return
íí 
await
íí 
Task
íí !
.
íí! "

FromResult
íí" ,
(
íí, -

restaurant
íí- 7
)
íí7 8
;
íí8 9
}
ìì 
NotifyError
ïï 
(
ïï 
$str
ïï /
)
ïï/ 0
;
ïï0 1
return
ññ 
await
ññ 
Task
ññ 
.
ññ 

FromResult
ññ (
<
ññ( )

Restaurant
ññ) 3
>
ññ3 4
(
ññ4 5
null
ññ5 9
)
ññ9 :
;
ññ: ;
}
óó 	
}
òò 
}ôô º
KD:\TI\git\v2\IHunger_API\IHunger\3 - Service\IHunger.Service\UserService.cs
	namespace 	
IHunger
 
. 
Service 
{ 
public 

class 
UserService 
: 
IUserService +
{		 
}

 
} 